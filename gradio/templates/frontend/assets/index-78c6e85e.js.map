{"version":3,"file":"index-78c6e85e.js","sources":["../../../../js/icons/src/Brush.svelte","../../../../js/icons/src/Color.svelte","../../../../js/icons/src/Erase.svelte","../../../../js/icons/src/Sketch.svelte","../../../../js/image/src/utils.ts","../../../../js/image/src/Cropper.svelte","../../../../node_modules/.pnpm/lazy-brush@1.0.1/node_modules/lazy-brush/src/Point.js","../../../../node_modules/.pnpm/lazy-brush@1.0.1/node_modules/lazy-brush/src/LazyPoint.js","../../../../node_modules/.pnpm/lazy-brush@1.0.1/node_modules/lazy-brush/src/LazyBrush.js","../../../../js/image/src/Sketch.svelte","../../../../js/image/src/Compose.svelte","../../../../js/image/src/ModifySketch.svelte","../../../../js/image/src/SketchSettings.svelte","../../../../js/image/src/Image.svelte","../../../../js/app/src/components/Image/Image.svelte","../../../../js/app/src/components/Image/index.ts"],"sourcesContent":["<svg width=\"100%\" height=\"100%\" viewBox=\"0 0 32 32\">\n\t<path\n\t\td=\"M28.828 3.172a4.094 4.094 0 0 0-5.656 0L4.05 22.292A6.954 6.954 0 0 0 2 27.242V30h2.756a6.952 6.952 0 0 0 4.95-2.05L28.828 8.829a3.999 3.999 0 0 0 0-5.657zM10.91 18.26l2.829 2.829l-2.122 2.121l-2.828-2.828zm-2.619 8.276A4.966 4.966 0 0 1 4.756 28H4v-.759a4.967 4.967 0 0 1 1.464-3.535l1.91-1.91l2.829 2.828zM27.415 7.414l-12.261 12.26l-2.829-2.828l12.262-12.26a2.047 2.047 0 0 1 2.828 0a2 2 0 0 1 0 2.828z\"\n\t\tfill=\"currentColor\"\n\t/>\n\t<path\n\t\td=\"M6.5 15a3.5 3.5 0 0 1-2.475-5.974l3.5-3.5a1.502 1.502 0 0 0 0-2.121a1.537 1.537 0 0 0-2.121 0L3.415 5.394L2 3.98l1.99-1.988a3.585 3.585 0 0 1 4.95 0a3.504 3.504 0 0 1 0 4.949L5.439 10.44a1.502 1.502 0 0 0 0 2.121a1.537 1.537 0 0 0 2.122 0l4.024-4.024L13 9.95l-4.025 4.024A3.475 3.475 0 0 1 6.5 15z\"\n\t\tfill=\"currentColor\"\n\t/>\n</svg>\n","<svg width=\"100%\" height=\"100%\" viewBox=\"0 0 32 32\">\n\t<circle cx=\"10\" cy=\"12\" r=\"2\" fill=\"currentColor\" />\n\t<circle cx=\"16\" cy=\"9\" r=\"2\" fill=\"currentColor\" />\n\t<circle cx=\"22\" cy=\"12\" r=\"2\" fill=\"currentColor\" />\n\t<circle cx=\"23\" cy=\"18\" r=\"2\" fill=\"currentColor\" />\n\t<circle cx=\"19\" cy=\"23\" r=\"2\" fill=\"currentColor\" />\n\t<path\n\t\tfill=\"currentColor\"\n\t\td=\"M16.54 2A14 14 0 0 0 2 16a4.82 4.82 0 0 0 6.09 4.65l1.12-.31a3 3 0 0 1 3.79 2.9V27a3 3 0 0 0 3 3a14 14 0 0 0 14-14.54A14.05 14.05 0 0 0 16.54 2Zm8.11 22.31A11.93 11.93 0 0 1 16 28a1 1 0 0 1-1-1v-3.76a5 5 0 0 0-5-5a5.07 5.07 0 0 0-1.33.18l-1.12.31A2.82 2.82 0 0 1 4 16A12 12 0 0 1 16.47 4A12.18 12.18 0 0 1 28 15.53a11.89 11.89 0 0 1-3.35 8.79Z\"\n\t/>\n</svg>\n","<svg\n\txmlns=\"http://www.w3.org/2000/svg\"\n\twidth=\"100%\"\n\theight=\"100%\"\n\tviewBox=\"0 0 32 32\"\n\t><path\n\t\tfill=\"currentColor\"\n\t\td=\"M7 27h23v2H7zm20.38-16.49l-7.93-7.92a2 2 0 0 0-2.83 0l-14 14a2 2 0 0 0 0 2.83L7.13 24h9.59l10.66-10.66a2 2 0 0 0 0-2.83zM15.89 22H8l-4-4l6.31-6.31l7.93 7.92zm3.76-3.76l-7.92-7.93L18 4l8 7.93z\"\n\t/></svg\n>\n","<svg\n\txmlns=\"http://www.w3.org/2000/svg\"\n\twidth=\"100%\"\n\theight=\"100%\"\n\tviewBox=\"0 0 24 24\"\n\tfill=\"none\"\n\tstroke=\"currentColor\"\n\tstroke-width=\"1.5\"\n\tstroke-linecap=\"round\"\n\tstroke-linejoin=\"round\"\n\tclass=\"feather feather-edit-2\"\n>\n\t<path d=\"M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z\" />\n</svg>\n","export const get_coordinates_of_clicked_image = (\n\tevt: MouseEvent\n): [number, number] | null => {\n\tlet image = evt.currentTarget as HTMLImageElement;\n\n\tconst imageRect = image.getBoundingClientRect();\n\tconst xScale = image.naturalWidth / imageRect.width;\n\tconst yScale = image.naturalHeight / imageRect.height;\n\tif (xScale > yScale) {\n\t\tconst displayed_width = imageRect.width;\n\t\tconst displayed_height = image.naturalHeight / xScale;\n\t\tconst y_offset = (imageRect.height - displayed_height) / 2;\n\t\tvar x = Math.round((evt.clientX - imageRect.left) * xScale);\n\t\tvar y = Math.round((evt.clientY - imageRect.top - y_offset) * xScale);\n\t} else {\n\t\tconst displayed_width = image.naturalWidth / yScale;\n\t\tconst displayed_height = imageRect.height;\n\t\tconst x_offset = (imageRect.width - displayed_width) / 2;\n\t\tvar x = Math.round((evt.clientX - imageRect.left - x_offset) * yScale);\n\t\tvar y = Math.round((evt.clientY - imageRect.top) * yScale);\n\t}\n\tconst type = typeof evt.currentTarget\n\tconsole.log(type);\n\tconsole.log(image.naturalWidth, image.naturalHeight);\n\tconsole.log(evt.clientX, evt.clientY, xScale, yScale, x, y);\n\tconsole.log(imageRect) \n\tif (x < 0 || x >= image.naturalWidth || y < 0 || y >= image.naturalHeight) {\n\t\treturn null;\n\t}\n\treturn [x, y];\n};\n\nexport const createLoadObserver = (handler: () => void) => {\n\tlet waiting = 0;\n\n\tconst onload = (el: EventTarget & { addEventListener: (type: string, listener: () => void) => void }) => {\n\t\twaiting++;\n\t\tel.addEventListener('load', () => {\n\t\t\twaiting--;\n\t\t\tif (waiting === 0) {\n\t\t\t\thandler();\n\t\t\t}\n\t\t});\n\t};\n\n\treturn onload;\n};\n","<svelte:options accessors={true} />\n\n<script lang=\"ts\">\n\timport Cropper from \"cropperjs\";\n\timport { onMount, createEventDispatcher } from \"svelte\";\n\n\texport let image: string;\n\tlet el: HTMLImageElement;\n\n\tconst dispatch = createEventDispatcher();\n\tlet cropper: Cropper;\n\n\texport function destroy() {\n\t\tcropper.destroy();\n\t}\n\n\texport function create() {\n\t\tif (cropper) {\n\t\t\tdestroy();\n\t\t}\n\t\tcropper = new Cropper(el, {\n\t\t\tautoCropArea: 1,\n\t\t\tcropend() {\n\t\t\t\tconst image_data = cropper.getCroppedCanvas().toDataURL();\n\t\t\t\tdispatch(\"crop\", image_data);\n\t\t\t}\n\t\t});\n\n\t\tdispatch(\"crop\", image);\n\t}\n</script>\n\n<img src={image} bind:this={el} alt=\"\" />\n","class Point {\n  /**\n   *\n   * @param {number} x\n   * @param {number} y\n   */\n  constructor(x, y) {\n    this.x = x\n    this.y = y\n  }\n}\n\nexport default Point\n","import Point from './Point'\n\nclass LazyPoint extends Point {\n  /**\n   * Update the x and y values\n   *\n   * @param {Point} point\n   */\n  update (point) {\n    this.x = point.x\n    this.y = point.y\n  }\n\n  /**\n   * Move the point to another position using an angle and distance\n   *\n   * @param {number} angle The angle in radians\n   * @param {number} distance How much the point should be moved\n   */\n  moveByAngle (angle, distance) {\n    // Rotate the angle based on the browser coordinate system ([0,0] in the top left)\n    const angleRotated = angle + (Math.PI / 2)\n\n    this.x = this.x + (Math.sin(angleRotated) * distance),\n    this.y = this.y - (Math.cos(angleRotated) * distance)\n  }\n\n  /**\n   * Check if this point is the same as another point\n   *\n   * @param {Point} point\n   * @returns {boolean}\n   */\n  equalsTo (point) {\n    return this.x === point.x && this.y === point.y\n  }\n\n  /**\n   * Get the difference for x and y axis to another point\n   *\n   * @param {Point} point\n   * @returns {Point}\n   */\n  getDifferenceTo (point) {\n    return new Point(this.x - point.x, this.y - point.y)\n  }\n\n  /**\n   * Calculate distance to another point\n   *\n   * @param {Point} point\n   * @returns {Point}\n   */\n  getDistanceTo (point) {\n    const diff = this.getDifferenceTo(point)\n\n    return Math.sqrt(Math.pow(diff.x, 2) + Math.pow(diff.y, 2))\n  }\n\n  /**\n   * Calculate the angle to another point\n   *\n   * @param {Point} point\n   * @returns {Point}\n   */\n  getAngleTo (point) {\n    const diff = this.getDifferenceTo(point)\n\n    return Math.atan2(diff.y, diff.x)\n  }\n\n  /**\n   * Return a simple object with x and y properties\n   *\n   * @returns {object}\n   */\n  toObject () {\n    return {\n      x: this.x,\n      y: this.y\n    }\n  }\n}\n\nexport default LazyPoint\n","import LazyPoint from './LazyPoint'\nconst RADIUS_DEFAULT = 30\n\nclass LazyBrush {\n  /**\n   * constructor\n   *\n   * @param {object} settings\n   * @param {number} settings.radius The radius for the lazy area\n   * @param {boolean} settings.enabled\n   */\n  constructor ({ radius = RADIUS_DEFAULT, enabled = true, initialPoint = { x: 0, y: 0 }} = {}) {\n    this.radius = radius\n    this._isEnabled = enabled\n\n    this.pointer = new LazyPoint(initialPoint.x, initialPoint.y)\n    this.brush = new LazyPoint(initialPoint.x, initialPoint.y)\n\n    this.angle = 0\n    this.distance = 0\n    this._hasMoved = false\n  }\n\n  /**\n   * Enable lazy brush calculations.\n   *\n   */\n  enable () {\n    this._isEnabled = true\n  }\n\n  /**\n   * Disable lazy brush calculations.\n   *\n   */\n  disable () {\n    this._isEnabled = false\n  }\n\n  /**\n   * @returns {boolean}\n   */\n  isEnabled () {\n    return this._isEnabled\n  }\n\n  /**\n   * Update the radius\n   *\n   * @param {number} radius\n   */\n  setRadius (radius) {\n    this.radius = radius\n  }\n\n  /**\n   * Return the current radius\n   *\n   * @returns {number}\n   */\n  getRadius () {\n    return this.radius\n  }\n\n  /**\n   * Return the brush coordinates as a simple object\n   *\n   * @returns {object}\n   */\n  getBrushCoordinates () {\n    return this.brush.toObject()\n  }\n\n  /**\n   * Return the pointer coordinates as a simple object\n   *\n   * @returns {object}\n   */\n  getPointerCoordinates () {\n    return this.pointer.toObject()\n  }\n\n  /**\n   * Return the brush as a LazyPoint\n   *\n   * @returns {LazyPoint}\n   */\n  getBrush () {\n    return this.brush\n  }\n\n  /**\n   * Return the pointer as a LazyPoint\n   *\n   * @returns {LazyPoint}\n   */\n  getPointer () {\n    return this.pointer\n  }\n\n  /**\n   * Return the angle between pointer and brush\n   *\n   * @returns {number} Angle in radians\n   */\n  getAngle () {\n    return this.angle\n  }\n\n  /**\n   * Return the distance between pointer and brush\n   *\n   * @returns {number} Distance in pixels\n   */\n  getDistance () {\n    return this.distance\n  }\n\n  /**\n   * Return if the previous update has moved the brush.\n   *\n   * @returns {boolean} Whether the brush moved previously.\n   */\n  brushHasMoved () {\n    return this._hasMoved\n  }\n\n  /**\n   * Updates the pointer point and calculates the new brush point.\n   *\n   * @param {Point} newPointerPoint\n   * @param {Object} options\n   * @param {Boolean} options.both Force update pointer and brush\n   * @returns {Boolean} Whether any of the two points changed\n   */\n  update (newPointerPoint, { both = false } = {}) {\n    this._hasMoved = false\n    if (this.pointer.equalsTo(newPointerPoint) && !both) {\n      return false\n    }\n\n    this.pointer.update(newPointerPoint)\n\n    if (both) {\n      this._hasMoved = true\n      this.brush.update(newPointerPoint)\n      return true\n    }\n\n    if (this._isEnabled) {\n      this.distance = this.pointer.getDistanceTo(this.brush)\n      this.angle = this.pointer.getAngleTo(this.brush)\n\n      if (this.distance > this.radius) {\n        this.brush.moveByAngle(this.angle, this.distance - this.radius)\n        this._hasMoved = true\n      }\n    } else {\n      this.distance = 0\n      this.angle = 0\n      this.brush.update(newPointerPoint)\n      this._hasMoved = true\n    }\n\n    return true\n  }\n}\n\nexport default LazyBrush\n\n","<script>\n\t// @ts-nocheck\n\n\timport { onMount, onDestroy, createEventDispatcher, tick } from \"svelte\";\n\timport { fade } from \"svelte/transition\";\n\timport { LazyBrush } from \"lazy-brush/src\";\n\timport ResizeObserver from \"resize-observer-polyfill\";\n\n\tconst dispatch = createEventDispatcher();\n\n\texport let value;\n\texport let value_img;\n\texport let mode = \"sketch\";\n\texport let brush_color = \"#0b0f19\";\n\texport let brush_radius;\n\texport let source;\n\n\texport let width = 400;\n\texport let height = 200;\n\texport let container_height = 200;\n\texport let shape;\n\n\t$: {\n\t\tif (shape && (width || height)) {\n\t\t\twidth = shape[0];\n\t\t\theight = shape[1];\n\t\t}\n\t}\n\n\tlet mounted;\n\n\tlet catenary_color = \"#aaa\";\n\n\tlet canvas_width = width;\n\tlet canvas_height = height;\n\n\t$: mounted && !value && clear();\n\n\tlet last_value_img;\n\n\t$: {\n\t\tif (mounted && value_img !== last_value_img) {\n\t\t\tlast_value_img = value_img;\n\n\t\t\tclear();\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (source === \"webcam\") {\n\t\t\t\t\tctx.temp.save();\n\t\t\t\t\tctx.temp.translate(width, 0);\n\t\t\t\t\tctx.temp.scale(-1, 1);\n\t\t\t\t\tctx.temp.drawImage(value_img, 0, 0);\n\t\t\t\t\tctx.temp.restore();\n\t\t\t\t} else {\n\t\t\t\t\tdraw_cropped_image();\n\t\t\t\t}\n\n\t\t\t\tctx.drawing.drawImage(canvas.temp, 0, 0, width, height);\n\n\t\t\t\tdraw_lines({ lines: lines.slice() });\n\t\t\t\ttrigger_on_change();\n\t\t\t}, 50);\n\t\t}\n\t}\n\n\tfunction mid_point(p1, p2) {\n\t\treturn {\n\t\t\tx: p1.x + (p2.x - p1.x) / 2,\n\t\t\ty: p1.y + (p2.y - p1.y) / 2\n\t\t};\n\t}\n\n\tconst canvas_types = [\n\t\t{\n\t\t\tname: \"interface\",\n\t\t\tzIndex: 15\n\t\t},\n\t\t{\n\t\t\tname: \"drawing\",\n\t\t\tzIndex: 11\n\t\t},\n\t\t{\n\t\t\tname: \"temp\",\n\t\t\tzIndex: 12\n\t\t},\n\t\t{\n\t\t\tname: \"mask\",\n\t\t\tzIndex: -1\n\t\t},\n\t\t{\n\t\t\tname: \"temp_fake\",\n\t\t\tzIndex: -2\n\t\t}\n\t];\n\n\tlet canvas = {};\n\tlet ctx = {};\n\tlet points = [];\n\tlet lines = [];\n\tlet mouse_has_moved = true;\n\tlet values_changed = true;\n\tlet is_drawing = false;\n\tlet is_pressing = false;\n\tlet lazy = null;\n\tlet canvas_container = null;\n\tlet canvas_observer = null;\n\tlet line_count = 0;\n\n\tfunction draw_cropped_image() {\n\t\tif (!shape) {\n\t\t\tctx.temp.drawImage(value_img, 0, 0, width, height);\n\t\t\treturn;\n\t\t}\n\n\t\tlet _width = value_img.naturalWidth;\n\t\tlet _height = value_img.naturalHeight;\n\n\t\tconst shape_ratio = shape[0] / shape[1];\n\t\tconst image_ratio = _width / _height;\n\n\t\tlet x = 0;\n\t\tlet y = 0;\n\n\t\tif (shape_ratio < image_ratio) {\n\t\t\t_width = shape[1] * image_ratio;\n\t\t\t_height = shape[1];\n\t\t\tx = (shape[0] - _width) / 2;\n\t\t} else if (shape_ratio > image_ratio) {\n\t\t\t_width = shape[0];\n\t\t\t_height = shape[0] / image_ratio;\n\t\t\ty = (shape[1] - _height) / 2;\n\t\t} else {\n\t\t\tx = 0;\n\t\t\ty = 0;\n\t\t\t_width = shape[0];\n\t\t\t_height = shape[1];\n\t\t}\n\n\t\tctx.temp.drawImage(value_img, x, y, _width, _height);\n\t}\n\n\tonMount(async () => {\n\t\tObject.keys(canvas).forEach((key) => {\n\t\t\tctx[key] = canvas[key].getContext(\"2d\");\n\t\t});\n\n\t\tawait tick();\n\n\t\tif (value_img) {\n\t\t\tvalue_img.addEventListener(\"load\", (_) => {\n\t\t\t\tif (source === \"webcam\") {\n\t\t\t\t\tctx.temp.save();\n\t\t\t\t\tctx.temp.translate(width, 0);\n\t\t\t\t\tctx.temp.scale(-1, 1);\n\t\t\t\t\tctx.temp.drawImage(value_img, 0, 0);\n\t\t\t\t\tctx.temp.restore();\n\t\t\t\t} else {\n\t\t\t\t\tdraw_cropped_image();\n\t\t\t\t}\n\t\t\t\tctx.drawing.drawImage(canvas.temp, 0, 0, width, height);\n\n\t\t\t\ttrigger_on_change();\n\t\t\t});\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (source === \"webcam\") {\n\t\t\t\t\tctx.temp.save();\n\t\t\t\t\tctx.temp.translate(width, 0);\n\t\t\t\t\tctx.temp.scale(-1, 1);\n\t\t\t\t\tctx.temp.drawImage(value_img, 0, 0);\n\t\t\t\t\tctx.temp.restore();\n\t\t\t\t} else {\n\t\t\t\t\tdraw_cropped_image();\n\t\t\t\t}\n\n\t\t\t\tctx.drawing.drawImage(canvas.temp, 0, 0, width, height);\n\n\t\t\t\tdraw_lines({ lines: lines.slice() });\n\t\t\t\ttrigger_on_change();\n\t\t\t}, 100);\n\t\t}\n\n\t\tlazy = new LazyBrush({\n\t\t\tradius: brush_radius * 0.05,\n\t\t\tenabled: true,\n\t\t\tinitialPoint: {\n\t\t\t\tx: width / 2,\n\t\t\t\ty: height / 2\n\t\t\t}\n\t\t});\n\n\t\tcanvas_observer = new ResizeObserver((entries, observer, ...rest) => {\n\t\t\thandle_canvas_resize(entries, observer);\n\t\t});\n\t\tcanvas_observer.observe(canvas_container);\n\n\t\tloop();\n\t\tmounted = true;\n\n\t\trequestAnimationFrame(() => {\n\t\t\tinit();\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tclear();\n\t\t\t});\n\t\t});\n\t});\n\n\tfunction init() {\n\t\tconst initX = width / 2;\n\t\tconst initY = height / 2;\n\t\tlazy.update({ x: initX, y: initY }, { both: true });\n\t\tlazy.update({ x: initX, y: initY }, { both: false });\n\t\tmouse_has_moved = true;\n\t\tvalues_changed = true;\n\t}\n\n\tonDestroy(() => {\n\t\tmounted = false;\n\t\tcanvas_observer.unobserve(canvas_container);\n\t});\n\n\tfunction redraw_image(_lines) {\n\t\tclear_canvas();\n\n\t\tif (value_img) {\n\t\t\tif (source === \"webcam\") {\n\t\t\t\tctx.temp.save();\n\t\t\t\tctx.temp.translate(width, 0);\n\t\t\t\tctx.temp.scale(-1, 1);\n\t\t\t\tctx.temp.drawImage(value_img, 0, 0);\n\t\t\t\tctx.temp.restore();\n\t\t\t} else {\n\t\t\t\tdraw_cropped_image();\n\t\t\t}\n\n\t\t\tif (!lines || !lines.length) {\n\t\t\t\tctx.drawing.drawImage(canvas.temp, 0, 0, width, height);\n\t\t\t}\n\t\t}\n\n\t\tdraw_lines({ lines: _lines });\n\t\tline_count = _lines.length;\n\n\t\tif (lines.length) {\n\t\t\tlines = _lines;\n\t\t}\n\n\t\tif (lines.length == 0) {\n\t\t\tdispatch(\"clear\");\n\t\t}\n\t}\n\n\texport function clear_mask() {\n\t\tconst _lines = [];\n\n\t\tredraw_image(_lines);\n\t\ttrigger_on_change();\n\t}\n\n\texport function undo() {\n\t\tconst _lines = lines.slice(0, -1);\n\n\t\tredraw_image(_lines);\n\t\ttrigger_on_change();\n\t}\n\n\tlet get_save_data = () => {\n\t\treturn JSON.stringify({\n\t\t\tlines: lines,\n\t\t\twidth: canvas_width,\n\t\t\theight: canvas_height\n\t\t});\n\t};\n\n\tlet draw_lines = ({ lines }) => {\n\t\tlines.forEach((line) => {\n\t\t\tconst { points: _points, brush_color, brush_radius } = line;\n\t\t\tdraw_points({\n\t\t\t\tpoints: _points,\n\t\t\t\tbrush_color,\n\t\t\t\tbrush_radius\n\t\t\t});\n\n\t\t\tif (mode === \"mask\") {\n\t\t\t\tdraw_fake_points({\n\t\t\t\t\tpoints: _points,\n\t\t\t\t\tbrush_color,\n\t\t\t\t\tbrush_radius\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tpoints = _points;\n\n\t\t\treturn;\n\t\t});\n\t\tsaveLine({ brush_color, brush_radius });\n\t\tif (mode === \"mask\") {\n\t\t\tsave_mask_line();\n\t\t}\n\t};\n\n\tlet handle_draw_start = (e) => {\n\t\te.preventDefault();\n\t\tis_pressing = true;\n\t\tconst { x, y } = get_pointer_pos(e);\n\t\tif (e.touches && e.touches.length > 0) {\n\t\t\tlazy.update({ x, y }, { both: true });\n\t\t}\n\t\thandle_pointer_move(x, y);\n\t\tline_count += 1;\n\t};\n\n\tlet handle_draw_move = (e) => {\n\t\te.preventDefault();\n\t\tconst { x, y } = get_pointer_pos(e);\n\t\thandle_pointer_move(x, y);\n\t};\n\n\tlet handle_draw_end = (e) => {\n\t\te.preventDefault();\n\t\thandle_draw_move(e);\n\t\tis_drawing = false;\n\t\tis_pressing = false;\n\t\tsaveLine();\n\n\t\tif (mode === \"mask\") {\n\t\t\tsave_mask_line();\n\t\t}\n\t};\n\n\tlet old_width = 0;\n\tlet old_height = 0;\n\tlet old_container_height = 0;\n\tlet add_lr_border = false;\n\n\tlet handle_canvas_resize = async () => {\n\t\tif (shape && canvas_container) {\n\t\t\tconst x = canvas_container?.getBoundingClientRect();\n\t\t\tconst shape_ratio = shape[0] / shape[1];\n\t\t\tconst container_ratio = x.width / x.height;\n\t\t\tadd_lr_border = shape_ratio < container_ratio;\n\t\t}\n\n\t\tif (\n\t\t\twidth === old_width &&\n\t\t\theight === old_height &&\n\t\t\told_container_height === container_height\n\t\t) {\n\t\t\treturn;\n\t\t}\n\t\tconst dimensions = { width: width, height: height };\n\n\t\tconst container_dimensions = {\n\t\t\theight: container_height,\n\t\t\twidth: container_height * (dimensions.width / dimensions.height)\n\t\t};\n\n\t\tawait Promise.all([\n\t\t\tset_canvas_size(canvas.interface, dimensions, container_dimensions),\n\t\t\tset_canvas_size(canvas.drawing, dimensions, container_dimensions),\n\t\t\tset_canvas_size(canvas.temp, dimensions, container_dimensions),\n\t\t\tset_canvas_size(canvas.temp_fake, dimensions, container_dimensions),\n\t\t\tset_canvas_size(canvas.mask, dimensions, container_dimensions, false)\n\t\t]);\n\n\t\tif (!brush_radius) {\n\t\t\tbrush_radius = 20 * (dimensions.width / container_dimensions.width);\n\t\t}\n\n\t\tloop({ once: true });\n\n\t\tsetTimeout(() => {\n\t\t\told_height = height;\n\t\t\told_width = width;\n\t\t\told_container_height = container_height;\n\t\t}, 10);\n\t\tawait tick();\n\n\t\tclear();\n\t};\n\n\t$: {\n\t\tif (lazy) {\n\t\t\tinit();\n\t\t\tlazy.setRadius(brush_radius * 0.05);\n\t\t}\n\t}\n\n\t$: {\n\t\tif (width || height) {\n\t\t\thandle_canvas_resize();\n\t\t}\n\t}\n\n\tlet set_canvas_size = async (canvas, dimensions, container, scale = true) => {\n\t\tif (!mounted) return;\n\t\tawait tick();\n\n\t\tconst dpr = window.devicePixelRatio || 1;\n\t\tcanvas.width = dimensions.width * (scale ? dpr : 1);\n\t\tcanvas.height = dimensions.height * (scale ? dpr : 1);\n\n\t\tconst ctx = canvas.getContext(\"2d\");\n\t\tscale && ctx.scale(dpr, dpr);\n\n\t\tcanvas.style.width = `${container.width}px`;\n\t\tcanvas.style.height = `${container.height}px`;\n\t};\n\n\tlet get_pointer_pos = (e) => {\n\t\tconst rect = canvas.interface.getBoundingClientRect();\n\n\t\tlet clientX = e.clientX;\n\t\tlet clientY = e.clientY;\n\t\tif (e.changedTouches && e.changedTouches.length > 0) {\n\t\t\tclientX = e.changedTouches[0].clientX;\n\t\t\tclientY = e.changedTouches[0].clientY;\n\t\t}\n\n\t\treturn {\n\t\t\tx: ((clientX - rect.left) / rect.width) * width,\n\t\t\ty: ((clientY - rect.top) / rect.height) * height\n\t\t};\n\t};\n\n\tlet handle_pointer_move = (x, y) => {\n\t\tlazy.update({ x: x, y: y });\n\t\tconst is_disabled = !lazy.isEnabled();\n\t\tif ((is_pressing && !is_drawing) || (is_disabled && is_pressing)) {\n\t\t\tis_drawing = true;\n\t\t\tpoints.push(lazy.brush.toObject());\n\t\t}\n\t\tif (is_drawing) {\n\t\t\tpoints.push(lazy.brush.toObject());\n\t\t\tdraw_points({\n\t\t\t\tpoints: points,\n\t\t\t\tbrush_color,\n\t\t\t\tbrush_radius\n\t\t\t});\n\n\t\t\tif (mode === \"mask\") {\n\t\t\t\tdraw_fake_points({\n\t\t\t\t\tpoints: points,\n\t\t\t\t\tbrush_color,\n\t\t\t\t\tbrush_radius\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\tmouse_has_moved = true;\n\t};\n\n\tlet draw_points = ({ points, brush_color, brush_radius }) => {\n\t\tif (!points || points.length < 2) return;\n\t\tctx.temp.lineJoin = \"round\";\n\t\tctx.temp.lineCap = \"round\";\n\n\t\tctx.temp.strokeStyle = brush_color;\n\t\tctx.temp.lineWidth = brush_radius;\n\t\tif (!points || points.length < 2) return;\n\t\tlet p1 = points[0];\n\t\tlet p2 = points[1];\n\t\tctx.temp.moveTo(p2.x, p2.y);\n\t\tctx.temp.beginPath();\n\t\tfor (var i = 1, len = points.length; i < len; i++) {\n\t\t\tvar midPoint = mid_point(p1, p2);\n\t\t\tctx.temp.quadraticCurveTo(p1.x, p1.y, midPoint.x, midPoint.y);\n\t\t\tp1 = points[i];\n\t\t\tp2 = points[i + 1];\n\t\t}\n\n\t\tctx.temp.lineTo(p1.x, p1.y);\n\t\tctx.temp.stroke();\n\t};\n\n\tlet draw_fake_points = ({ points, brush_color, brush_radius }) => {\n\t\tif (!points || points.length < 2) return;\n\n\t\tctx.temp_fake.lineJoin = \"round\";\n\t\tctx.temp_fake.lineCap = \"round\";\n\t\tctx.temp_fake.strokeStyle = \"#fff\";\n\t\tctx.temp_fake.lineWidth = brush_radius;\n\t\tlet p1 = points[0];\n\t\tlet p2 = points[1];\n\t\tctx.temp_fake.moveTo(p2.x, p2.y);\n\t\tctx.temp_fake.beginPath();\n\t\tfor (var i = 1, len = points.length; i < len; i++) {\n\t\t\tvar midPoint = mid_point(p1, p2);\n\t\t\tctx.temp_fake.quadraticCurveTo(p1.x, p1.y, midPoint.x, midPoint.y);\n\t\t\tp1 = points[i];\n\t\t\tp2 = points[i + 1];\n\t\t}\n\n\t\tctx.temp_fake.lineTo(p1.x, p1.y);\n\t\tctx.temp_fake.stroke();\n\t};\n\n\tlet save_mask_line = () => {\n\t\tif (points.length < 1) return;\n\t\tpoints.length = 0;\n\t\tctx.mask.drawImage(canvas.temp_fake, 0, 0, width, height);\n\n\t\ttrigger_on_change();\n\t};\n\n\tlet saveLine = () => {\n\t\tif (points.length < 1) return;\n\n\t\tlines.push({\n\t\t\tpoints: points.slice(),\n\t\t\tbrush_color: brush_color,\n\t\t\tbrush_radius\n\t\t});\n\n\t\tif (mode !== \"mask\") {\n\t\t\tpoints.length = 0;\n\t\t}\n\n\t\tctx.drawing.drawImage(canvas.temp, 0, 0, width, height);\n\n\t\ttrigger_on_change();\n\t};\n\n\tlet trigger_on_change = () => {\n\t\tconst x = get_image_data();\n\t\tdispatch(\"change\", x);\n\t};\n\n\texport function clear() {\n\t\tlines = [];\n\t\tclear_canvas();\n\t\tline_count = 0;\n\n\t\treturn true;\n\t}\n\n\tfunction clear_canvas() {\n\t\tvalues_changed = true;\n\t\tctx.temp.clearRect(0, 0, width, height);\n\n\t\tctx.temp.fillStyle = mode === \"mask\" ? \"transparent\" : \"#FFFFFF\";\n\t\tctx.temp.fillRect(0, 0, width, height);\n\n\t\tif (mode === \"mask\") {\n\t\t\tctx.temp_fake.clearRect(\n\t\t\t\t0,\n\t\t\t\t0,\n\t\t\t\tcanvas.temp_fake.width,\n\t\t\t\tcanvas.temp_fake.height\n\t\t\t);\n\t\t\tctx.mask.clearRect(0, 0, width, height);\n\t\t\tctx.mask.fillStyle = \"#000\";\n\t\t\tctx.mask.fillRect(0, 0, width, height);\n\t\t}\n\t}\n\n\tlet loop = ({ once = false } = {}) => {\n\t\tif (mouse_has_moved || values_changed) {\n\t\t\tconst pointer = lazy.getPointerCoordinates();\n\t\t\tconst brush = lazy.getBrushCoordinates();\n\t\t\tdraw_interface(ctx.interface, pointer, brush);\n\t\t\tmouse_has_moved = false;\n\t\t\tvalues_changed = false;\n\t\t}\n\t\tif (!once) {\n\t\t\twindow.requestAnimationFrame(() => {\n\t\t\t\tloop();\n\t\t\t});\n\t\t}\n\t};\n\n\t$: brush_dot = brush_radius * 0.075;\n\n\tlet draw_interface = (ctx, pointer, brush) => {\n\t\tctx.clearRect(0, 0, width, height);\n\n\t\t// brush preview\n\t\tctx.beginPath();\n\t\tctx.fillStyle = brush_color;\n\t\tctx.arc(brush.x, brush.y, brush_radius / 2, 0, Math.PI * 2, true);\n\t\tctx.fill();\n\n\t\t// tiny brush point dot\n\t\tctx.beginPath();\n\t\tctx.fillStyle = catenary_color;\n\t\tctx.arc(brush.x, brush.y, brush_dot, 0, Math.PI * 2, true);\n\t\tctx.fill();\n\t};\n\n\texport function get_image_data() {\n\t\treturn mode === \"mask\"\n\t\t\t? canvas.mask.toDataURL(\"image/jpg\")\n\t\t\t: canvas.drawing.toDataURL(\"image/jpg\");\n\t}\n</script>\n\n<div\n\tclass=\"wrap\"\n\tbind:this={canvas_container}\n\tbind:offsetWidth={canvas_width}\n\tbind:offsetHeight={canvas_height}\n>\n\t{#if line_count === 0}\n\t\t<div transition:fade={{ duration: 50 }} class=\"start-prompt\">\n\t\t\tStart drawing\n\t\t</div>\n\t{/if}\n\t{#each canvas_types as { name, zIndex }}\n\t\t<canvas\n\t\t\tkey={name}\n\t\t\tstyle=\" z-index:{zIndex};\"\n\t\t\tclass:lr={add_lr_border}\n\t\t\tclass:tb={!add_lr_border}\n\t\t\tbind:this={canvas[name]}\n\t\t\ton:mousedown={name === \"interface\" ? handle_draw_start : undefined}\n\t\t\ton:mousemove={name === \"interface\" ? handle_draw_move : undefined}\n\t\t\ton:mouseup={name === \"interface\" ? handle_draw_end : undefined}\n\t\t\ton:mouseout={name === \"interface\" ? handle_draw_end : undefined}\n\t\t\ton:blur={name === \"interface\" ? handle_draw_end : undefined}\n\t\t\ton:touchstart={name === \"interface\" ? handle_draw_start : undefined}\n\t\t\ton:touchmove={name === \"interface\" ? handle_draw_move : undefined}\n\t\t\ton:touchend={name === \"interface\" ? handle_draw_end : undefined}\n\t\t\ton:touchcancel={name === \"interface\" ? handle_draw_end : undefined}\n\t\t\ton:click|stopPropagation\n\t\t/>\n\t{/each}\n</div>\n\n<style>\n\tcanvas {\n\t\tdisplay: block;\n\t\tposition: absolute;\n\t\ttop: 0px;\n\t\tright: 0px;\n\t\tbottom: 0px;\n\t\tleft: 0px;\n\t\tmargin: auto;\n\t}\n\n\t.lr {\n\t\tborder-right: 1px solid var(--border-color-primary);\n\t\tborder-left: 1px solid var(--border-color-primary);\n\t}\n\n\t.tb {\n\t\tborder-top: 1px solid var(--border-color-primary);\n\t\tborder-bottom: 1px solid var(--border-color-primary);\n\t}\n\n\tcanvas:hover {\n\t\tcursor: none;\n\t}\n\n\t.wrap {\n\t\tposition: relative;\n\t\twidth: var(--size-full);\n\t\theight: var(--size-full);\n\t\ttouch-action: none;\n\t}\n\n\t.start-prompt {\n\t\tdisplay: flex;\n\t\tposition: absolute;\n\t\ttop: 0px;\n\t\tright: 0px;\n\t\tbottom: 0px;\n\t\tleft: 0px;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\tz-index: var(--layer-4);\n\t\ttouch-action: none;\n\t\tpointer-events: none;\n\t\tcolor: var(--body-text-color-subdued);\n\t}\n</style>\n","<script>\n\t// @ts-nocheck\n\n\timport { onMount, onDestroy, createEventDispatcher, tick } from \"svelte\";\n\timport { draw, fade } from \"svelte/transition\";\n\timport { LazyBrush } from \"lazy-brush/src\";\n\timport ResizeObserver from \"resize-observer-polyfill\";\n\timport { get_coordinates_of_clicked_image } from \"./utils\";\n\n\tconst dispatch = createEventDispatcher();\n\n\texport let value;\n\texport let value_img;\n\texport let mode = \"sketch\";\n\texport let brush_color = \"#0b0f19\";\n\texport let brush_radius;\n\texport let source;\n\n\texport let width = 400;\n\texport let height = 200;\n\texport let container_height = 200;\n\texport let shape;\n\t\n\t$: {\n\t\tconsole.log('source = ', source, 'mode = ', mode, 'width = ', width, 'height = ', height, 'container_height = ', container_height);\t\n\t}\n\n\t$: {\n\t\tif (shape && (width || height)) {\n\t\t\tconsole.log(\"shape and width or height\");\n\t\t\tconsole.log(shape, width, height);\n\t\t\twidth = shape[0];\n\t\t\theight = shape[1];\n\t\t}\n\t}\n\n\tlet mounted;\n\n\tlet catenary_color = \"#aaa\";\n\n\tlet canvas_width = width;\n\tlet canvas_height = height;\n\n\t$: mounted && !value && clear();\n\n\tfunction mid_point(p1, p2) {\n\t\treturn {\n\t\t\tx: p1.x + (p2.x - p1.x) / 2,\n\t\t\ty: p1.y + (p2.y - p1.y) / 2\n\t\t};\n\t}\n\n\tconst canvas_types = [\n\t\t{\n\t\t\tname: \"interface\",\n\t\t\tzIndex: 15\n\t\t},\n\t\t{\n\t\t\tname: \"drawing\",\n\t\t\tzIndex: 16\n\t\t},\n\t\t{\n\t\t\tname: \"temp\",\n\t\t\tzIndex: 12\n\t\t},\n\t\t{\n\t\t\tname: \"mask\",\n\t\t\tzIndex: -1\n\t\t},\n\t\t{\n\t\t\tname: \"temp_fake\",\n\t\t\tzIndex: -2\n\t\t}\n\t];\n\n\tlet canvas = {};\n\tlet ctx = {};\n\tlet points = [];\n\tlet lines = [];\n\tlet mouse_has_moved = true;\n\tlet values_changed = true;\n\tlet is_drawing = false;\n\tlet is_pressing = false;\n\tlet lazy = null;\n\tlet canvas_container = null;\n\tlet canvas_observer = null;\n\tlet line_count = 0;\n\tlet value_img_data_original = null;\n\tlet value_img_data_opaque = null;\n\tlet value_img_opaque = null;\n\n\tlet changed_objects = [];\n\tlet cropped_image = null;\n\tlet current_object_id = 0;\n\tlet cropping_img_data = null;\n\tlet cropping_img = null;\n\n\t//user must wait for image to load before drawing\n\tfunction imagedata_to_image (imagedata) {\n\t\tvar canvas = document.createElement ('canvas');\n\t\tvar ctx = canvas.getContext ('2d');\n\t\tcanvas.width = imagedata.width;\n\t\tcanvas.height = imagedata.height;  \t\t\n\t\tctx.putImageData (imagedata, 0, 0);\n\t\tvar dataURL = canvas.toDataURL ();\n\t\tvar img = new Image ();\n\t\timg.src = dataURL;\t\t\n\t\treturn img;\n\t}\n\n\tfunction image_to_imagedata(image) {\n\t\tconst canvas = document.createElement('canvas');\n\t\tcanvas.width = image.naturalWidth;\n\t\tcanvas.height = image.naturalHeight;\n\t\tconst ctx = canvas.getContext('2d');\n\t\tctx.drawImage(image, 0, 0);\n\t\treturn ctx.getImageData(0, 0, canvas.width, canvas.height);\n\t}\n\n\t$: {\n\t\tconsole.log(\"Compose.svelte: value changed = \", value);\n\t\tconsole.log(\"Compose.svelte: value_img.complete:\", value_img.complete)\n\t}\n\n\tfunction draw_cropped_image() {\n\t\tif (!shape) {\n\n\t\t\t//console.log('draw_cropped_image: ', value_img);\n\t\n\t\t\tconst x = canvas.temp.getBoundingClientRect();\n\t\t\t//console.log(`canvas width: ${ctx.temp.canvas.width}, canvas height: ${ctx.temp.canvas.height}`);\n\t\t\t//console.log(`img width: ${width}, height: ${height}`);\n\t\t\tif (value_img_opaque != null && value_img_opaque.complete == true) {\n\t\t\t\tctx.temp.drawImage(value_img_opaque, 0, 0, width, height);\n\t\t\t\tif (changed_objects.length > 0) {\n\t\t\t\t\tfor (let i = 0; i < changed_objects.length; i++) {\n\t\t\t\t\t\tconst { img, pos } = changed_objects[i];\n\t\t\t\t\t\t//console.log(pos, img);\n\t\t\t\t\t\tctx.temp.drawImage(img, pos.left, pos.top);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tconsole.log('shape:')\n\t\tconsole.log(shape)\n\t\tlet _width = value_img.naturalWidth;\n\t\tlet _height = value_img.naturalHeight;\n\n\t\tconst shape_ratio = shape[0] / shape[1];\n\t\tconst image_ratio = _width / _height;\n\n\t\tlet x = 0;\n\t\tlet y = 0;\n\n\t\tif (shape_ratio < image_ratio) {\n\t\t\t_width = shape[1] * image_ratio;\n\t\t\t_height = shape[1];\n\t\t\tx = (shape[0] - _width) / 2;\n\t\t} else if (shape_ratio > image_ratio) {\n\t\t\t_width = shape[0];\n\t\t\t_height = shape[0] / image_ratio;\n\t\t\ty = (shape[1] - _height) / 2;\n\t\t} else {\n\t\t\tx = 0;\n\t\t\ty = 0;\n\t\t\t_width = shape[0];\n\t\t\t_height = shape[1];\n\t\t}\n\n\t\tctx.temp.drawImage(value_img, x, y, _width, _height);\n\t}\n\n\tonMount(async () => {\n\t\tObject.keys(canvas).forEach((key) => {\n\t\t\tctx[key] = canvas[key].getContext(\"2d\");\n\t\t});\n\n\t\tawait tick();\n\n\t\tif (value_img) {\n\t\t\t//This block repeats the code in the loaded event listener block below, but it is necessary to ensure that the image is drawn\n\t\t\t//This is because for the first time, the value_img is already loaded by the time the event listener is added\n\t\t\tconsole.log(\"Compose.svelte:onMount: value_img.complete:\", value_img.complete)\n\t\t\tconsole.log('Compose.svelte:onMount: value_img:', value_img)\t\t\t\n\n\t\t\tchanged_objects = [];\n\t\t\tcropped_image = null;\n\t\t\tcurrent_object_id = 0;\n\t\t\tcropping_img_data = null;\n\t\t\tcropping_img = null;\n\n\t\t\tvalue_img_data_original = image_to_imagedata(value_img);\n\t\t\tvalue_img_data_opaque = new ImageData(value_img_data_original.width, value_img_data_original.height);\n\t\t\tvalue_img_data_opaque.data.set(value_img_data_original.data);\n\t\t\tvar pixels = value_img_data_opaque.data; // get the pixel array\n\t\t\tfor (var i = 0; i < pixels.length; i += 4) { \n\t\t\t\tif (pixels[i+3] != 255) {\n\t\t\t\t\tpixels[i+3] = 255; \n\t\t\t\t}\n\t\t\t}\n\t\t\tvalue_img_opaque = imagedata_to_image(value_img_data_opaque);\n\t\t\tvalue_img_opaque.onload = (_) => {\n\t\t\t\tconsole.log('value_img_opaque loaded');\n\t\t\t\tconsole.log(\"value_img_opaque:\", value_img_opaque);\n\t\t\t\tdraw_cropped_image();\n\t\t\t\tctx.drawing.drawImage(canvas.temp, 0, 0, width, height);\t\t\t\n\t\t\t};\n\t\t\t//This trigger on change somehow doesn't send the mask back. Deal with it in components.py. TBD: do we really need\n\t\t\t//to call this here? Or do we need mask at all for Compose?\n\t\t\ttrigger_on_change('onMount line 211');\n\t\t}\n\n\t\tvalue_img.addEventListener(\"load\", (_) => {\n\t\t\tconsole.log('Compose.svelte:value_img loaded');\n\n\t\t\tchanged_objects = [];\n\t\t\tcropped_image = null;\n\t\t\tcurrent_object_id = 0;\n\t\t\tcropping_img_data = null;\n\t\t\tcropping_img = null;\n\n\t\t\tvalue_img_data_original = image_to_imagedata(value_img);\n\t\t\tvalue_img_data_opaque = new ImageData(value_img_data_original.width, value_img_data_original.height);\n\t\t\tvalue_img_data_opaque.data.set(value_img_data_original.data);\n\t\t\tvar pixels = value_img_data_opaque.data; // get the pixel array\n\t\t\tfor (var i = 0; i < pixels.length; i += 4) { \n\t\t\t\tif (pixels[i+3] != 255) {\n\t\t\t\t\tpixels[i+3] = 255; \n\t\t\t\t}\n\t\t\t}\n\t\t\tvalue_img_opaque = imagedata_to_image(value_img_data_opaque);\n\t\t\tconsole.log(\"value_img_opaque.complete:\", value_img_opaque.complete);\n\t\t\tvalue_img_opaque.onload = (_) => {\n\t\t\t\tconsole.log('value_img_opaque loaded');\n\t\t\t\tconsole.log(\"value_img_opaque:\", value_img_opaque);\n\t\t\t\tdraw_cropped_image();\n\t\t\t\tctx.drawing.drawImage(canvas.temp, 0, 0, width, height);\t\t\t\n\t\t\t};\n\t\t});\n\n\t\t// If the mouse is dragging an object but released outside, object is deleted from scene\n\t\tdocument.onmouseup = (_) => {\n\t\t\tif (is_pressing) \n\t\t\t{\n\t\t\t\tconsole.log(\"handle drag ended outside element\"); \t//remove this object\n\t\t\t\tis_pressing = false;\n\t\t\t\tmouse_has_moved = true;\n\n\t\t\t\t//clear_canvas();\n\t\t\t\t//ctx.drawing.clearRect(0, 0, width, height);\n\t\t\t\t//draw_cropped_image();\n\t\t\t\terase_object(current_object_id);\n\n\t\t\t\tdispatch(\"select\", { index: [10000, 10000], value: current_object_id });\n\t\t\t\tconsole.log(\"handle_drag_end (to outside): dispatch (select)\")\n\t\t\t}\n\t\t}\n\n\t\tsetTimeout(() => {\n\t\t\tif (source === \"webcam\") {\n\t\t\t\tctx.temp.save();\n\t\t\t\tctx.temp.translate(width, 0);\n\t\t\t\tctx.temp.scale(-1, 1);\n\t\t\t\tctx.temp.drawImage(value_img, 0, 0);\n\t\t\t\tctx.temp.restore();\n\t\t\t} else {\n\t\t\t\tconsole.log('setTimeout: draw_cropped_image')\n\t\t\t\tdraw_cropped_image();\n\t\t\t}\n\n\t\t\tctx.drawing.drawImage(canvas.temp, 0, 0, width, height);\n\n\t\t\tdraw_lines({ lines: lines.slice() });\n\t\t\ttrigger_on_change('onMount line 236');\n\t\t}, 100);\n\n\t\tlazy = new LazyBrush({\n\t\t\tradius: brush_radius * 0.05,\n\t\t\tenabled: true,\n\t\t\tinitialPoint: {\n\t\t\t\tx: width / 2,\n\t\t\t\ty: height / 2\n\t\t\t}\n\t\t});\n\n\t\tcanvas_observer = new ResizeObserver((entries, observer, ...rest) => {\n\t\t\thandle_canvas_resize(entries, observer);\n\t\t});\n\t\tcanvas_observer.observe(canvas_container);\n\n\t\tloop();\n\t\tmounted = true;\n\n\t\trequestAnimationFrame(() => {\n\t\t\tinit();\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tclear();\n\t\t\t});\n\t\t});\n\t});\n\n\tfunction init() {\n\t\tconst initX = width / 2;\n\t\tconst initY = height / 2;\n\t\tlazy.update({ x: initX, y: initY }, { both: true });\n\t\tlazy.update({ x: initX, y: initY }, { both: false });\n\t\tmouse_has_moved = true;\n\t\tvalues_changed = true;\n\t}\n\n\tonDestroy(() => {\n\t\tmounted = false;\n\t\tcanvas_observer.unobserve(canvas_container);\n\t});\n\n\tfunction redraw_image(_lines) {\n\t\tclear_canvas();\n\n\t\tif (value_img) {\n\t\t\tif (source === \"webcam\") {\n\t\t\t\tctx.temp.save();\n\t\t\t\tctx.temp.translate(width, 0);\n\t\t\t\tctx.temp.scale(-1, 1);\n\t\t\t\tctx.temp.drawImage(value_img, 0, 0);\n\t\t\t\tctx.temp.restore();\n\t\t\t} else {\n\t\t\t\tdraw_cropped_image();\n\t\t\t}\n\n\t\t\tif (!lines || !lines.length) {\n\t\t\t\tctx.drawing.drawImage(canvas.temp, 0, 0, width, height);\n\t\t\t}\n\t\t}\n\n\t\tdraw_lines({ lines: _lines });\n\t\tline_count = _lines.length;\n\n\t\tif (lines.length) {\n\t\t\tlines = _lines;\n\t\t}\n\n\t\tif (lines.length == 0) {\n\t\t\tdispatch(\"clear\");\n\t\t}\n\t}\n\n\texport function clear_mask() {\n\t\tconst _lines = [];\n\n\t\tredraw_image(_lines);\n\t\ttrigger_on_change('clear_mask');\n\t}\n\n\texport function undo() {\n\t\tconst _lines = lines.slice(0, -1);\n\n\t\tredraw_image(_lines);\n\t\ttrigger_on_change('undo');\n\t}\n\n\tlet get_save_data = () => {\n\t\treturn JSON.stringify({\n\t\t\tlines: lines,\n\t\t\twidth: canvas_width,\n\t\t\theight: canvas_height\n\t\t});\n\t};\n\n\tlet draw_lines = ({ lines }) => {\n\t\tlines.forEach((line) => {\n\t\t\tconst { points: _points, brush_color, brush_radius } = line;\n\t\t\tdraw_points({\n\t\t\t\tpoints: _points,\n\t\t\t\tbrush_color,\n\t\t\t\tbrush_radius\n\t\t\t});\n\n\t\t\tif (mode === \"mask\") {\n\t\t\t\tdraw_fake_points({\n\t\t\t\t\tpoints: _points,\n\t\t\t\t\tbrush_color,\n\t\t\t\t\tbrush_radius\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tpoints = _points;\n\n\t\t\treturn;\n\t\t});\n\t\tsaveLine({ brush_color, brush_radius });\n\t\tif (mode === \"mask\") {\n\t\t\tsave_mask_line();\n\t\t}\n\t};\n\n\tlet handle_draw_start = (e) => {\n\t\te.preventDefault();\n\t\tis_pressing = true;\n\t\tconst { x, y } = get_pointer_pos(e);\n\t\tif (e.touches && e.touches.length > 0) {\n\t\t\tlazy.update({ x, y }, { both: true });\n\t\t}\n\t\thandle_pointer_move(x, y);\n\t\tline_count += 1;\n\t};\n\n\tlet handle_draw_move = (e) => {\n\t\te.preventDefault();\n\t\tconst { x, y } = get_pointer_pos(e);\n\n\t\tclear_canvas()\n\n\t\thandle_pointer_move(x, y);\n\t};\n\n\tlet handle_draw_end = (e) => {\n\t\te.preventDefault();\n\t\thandle_draw_move(e);\n\t\tis_drawing = false;\n\t\tis_pressing = false;\n\t\tsaveLine();\n\n\t\tif (mode === \"mask\") {\n\t\t\tsave_mask_line();\n\t\t}\n\t};\n\n\t// Create the path\n\tvar drag_start_x = null;\n\tvar drag_start_y = null;\n\tvar cropRect = {\n\ttop: 0,\n\tleft: 0,\n\twidth: 0,\n\theight: 0\n\t};\n\n\tlet find_bounding_box = (selected_obj_id) => {\n\t\tlet min_x = value_img_data_original.width;\n\t\tlet min_y = value_img_data_original.height;\n\t\tlet max_x = 0;\n\t\tlet max_y = 0;\n\n\t\tfor (let y = 0; y < value_img_data_original.height; y++) {\n\t\t\tfor (let x = 0; x < value_img_data_original.width; x++) {\n\t\t\t\tconst index = (y * value_img_data_original.width + x) * 4;\n\t\t\t\tconst pixels = value_img_data_original.data;\n\t\t\t\tconst pixel_value = pixels[index + 3];\n\n\t\t\t\tif (pixel_value === selected_obj_id) {\n\t\t\t\t\tmin_x = Math.min(min_x, x);\n\t\t\t\t\tmin_y = Math.min(min_y, y);\n\t\t\t\t\tmax_x = Math.max(max_x, x);\n\t\t\t\t\tmax_y = Math.max(max_y, y);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\ttop: min_y,\n\t\t\tleft: min_x,\n\t\t\twidth: max_x - min_x,\n\t\t\theight: max_y - min_y,\n\t\t};\n\t};\n\n\tfunction create_cropped_image(rect, obj_id) {\n\t\treturn new Promise((resolve) => {\n\t\t\tcropping_img_data = new ImageData(value_img_data_original.width, value_img_data_original.height);\n\t\t\tcropping_img_data.data.set(value_img_data_original.data);\n\t\t\tfor (let y = 0; y < cropping_img_data.height; y++) {\n\t\t\t\tfor (let x = 0; x < cropping_img_data.width; x++) {\n\t\t\t\t\tconst index = (y * cropping_img_data.width + x) * 4;\n\t\t\t\t\tconst pixels_original = value_img_data_original.data;\n\t\t\t\t\tvar pixels = cropping_img_data.data;\n\t\t\t\t\tif (pixels_original[index + 3] == obj_id) {\n\t\t\t\t\t\tpixels[index + 3] = 255;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tpixels[index + 3] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t//console.log(\"cropping_img_data =\", cropping_img_data);\n\t\t\tcropping_img = imagedata_to_image(cropping_img_data);\n\t\t\t//console.log(\"cropping_img =\", cropping_img);\n\n\t\t\tcropping_img.addEventListener(\"load\", () => {\n\t\t\t\tconst canvas = document.createElement(\"canvas\");\n\t\t\t\tcanvas.width = rect.width;\n\t\t\t\tcanvas.height = rect.height;\n\t\t\t\tconst ctx = canvas.getContext(\"2d\");\n\t\t\t\tctx.drawImage(\n\t\t\t\t\tcropping_img,\n\t\t\t\t\tcropRect.left,\n\t\t\t\t\trect.top,\n\t\t\t\t\trect.width,\n\t\t\t\t\trect.height,\n\t\t\t\t\t0,\n\t\t\t\t\t0,\n\t\t\t\t\trect.width,\n\t\t\t\t\trect.height\n\t\t\t\t);\n\t\t\t\tvar dst_img = new Image();\n\t\t\t\tdst_img.src = canvas.toDataURL();\n\t\t\t\t//console.log(\"dst_img =\", dst_img);\n\t\t\t\tresolve(dst_img);\n\t\t\t});\n\t\t});\n\t}\n\n\tfunction construct_current_object(current_object_id)\n\t{\n\t\tlet ids = changed_objects.map(obj => obj.id);\n\t\tconsole.log(\"changed obj ids =\", ids);\n\t\tif (ids.includes(current_object_id)) {\n\t\t  \tconsole.log(\"current_object_id is a chaged object\");\n\t\t\tlet current_obj = changed_objects.find(obj => obj.id === current_object_id);\n\t\t\tconsole.log(\"current_obj =\", current_obj);\t\t\t\n\t\t\tcropRect = current_obj.pos;\n\t\t\tcropped_image = current_obj.img;\n\t\t\t//console.log(\"cropped_image =\", cropped_image);\n\t\t\t//console.log(\"cropRect =\", cropRect);\n\t\t}\n\t\telse {\n\t\t\tcropRect = find_bounding_box(current_object_id);\n\t\t\tasync function blocking_function() {\n\t\t\t\tcropped_image = await create_cropped_image(cropRect, current_object_id);\n\t\t\t}\n\t\t\tblocking_function();\n\t\t\t//console.log(\"cropped_image =\", cropped_image);\n\t\t\t//console.log(\"cropRect =\", cropRect);\n\t\t}\n\t}\n\n\tfunction identify_object_id(x, y) {\n\t\tconst index = (Math.round(y) * value_img_data_original.width + Math.round(x)) * 4;\n\t\tconst pixels = value_img_data_original.data; \n\t\tconsole.log(`imageDataOriginal width and height: ${value_img_data_original.width}, ${value_img_data_original.height}`)\n\t\tconsole.log(`pixels length: ${pixels.length}`)\n\t\tconsole.log(`image space x and y: ${x}, ${y}`); \n\t\tconsole.log(`pixel index: ${index}`);\n\t\tconsole.log(`pixel value: ${pixels[index]}, ${pixels[index+1]}, ${pixels[index+2]}, ${pixels[index+3]}`);\n\t\tvar id_selected = pixels[index+3];\n\t\tif (changed_objects.length > 0) {\n\t\t\tfor (let i = changed_objects.length - 1; i >= 0 ; i--) {\n\t\t\t\tconst { id, pos } = changed_objects[i];\n\t\t\t\tconsole.log(id, pos);\n\t\t\t\tif (x >= pos.left && x < pos.left + pos.width && y >= pos.top && y < pos.top + pos.height)\n\t\t\t\t{\n\t\t\t\t\tid_selected = id;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn id_selected;\n\t}\n\n\tlet handle_drag_start = (e) => {\n\t\te.preventDefault();\n\t\tis_pressing = true;\n\t\tconst { x, y } = get_pointer_pos(e);\n\n\t\tdrag_start_x = x;\n\t\tdrag_start_y = y;\n\n\t\tcurrent_object_id = identify_object_id(x, y);\n\t\tif (current_object_id == 0) {\n\t\t\tconsole.log(\"no object is selected\");\n\t\t\tis_pressing = false\n\t\t\treturn;\n\t\t}\n\t\tconstruct_current_object(current_object_id);\t\t\n\t\tconsole.log(\"handle_drag_start: changed_objects\", changed_objects)\n\t};\n\n\tlet handle_drag_move = (e) => {\n\t\te.preventDefault();\n\t\tif (!is_pressing) {\n\t\t\treturn;\n\t\t}\n\n\t\tclear_canvas();\n\t\tctx.drawing.clearRect(0, 0, width, height);\n\t\tdraw_cropped_image();\n\t\n\t\tconst { x, y } = get_pointer_pos(e);\n\t\tconst drag_move_x = x - drag_start_x;\n\t\tconst drag_move_y = y - drag_start_y;\n\t\tconst draw_x = cropRect.left + drag_move_x;\n\t\tconst draw_y = cropRect.top + drag_move_y;\n\t\tif (cropped_image && cropped_image.complete) {\n\t\t\tctx.drawing.drawImage(cropped_image, draw_x, draw_y);\n\t\t}\n\t};\n\n\tlet erase_object = (obj_id) => {\n\t\tlet min_x = value_img_data_opaque.width;\n\t\tlet min_y = value_img_data_opaque.height;\n\t\tlet max_x = 0;\n\t\tlet max_y = 0;\n\n\t\tlet ids = changed_objects.map(obj => obj.id);\n\t\tconsole.log(\"erase_object: changed obj ids =\", ids);\n\t\tif (ids.includes(current_object_id)) {\n\t\t\tlet index = changed_objects.findLastIndex(obj => obj.id === obj_id);\n\t\t\tfor (let i = index; i >= 0; i--) {\n\t\t\t\tif (changed_objects[i].id === obj_id) {\n\t\t\t\t\tchanged_objects.splice(i, 1);\n\t\t\t\t} \n\t\t\t}\n\t\t}\n\n\t\t//improve: not be necessary for objects that have been erased before\n\t\tfor (let y = 0; y < value_img_data_opaque.height; y++) {\n\t\t\tfor (let x = 0; x < value_img_data_opaque.width; x++) {\n\t\t\t\tconst index = (y * value_img_data_opaque.width + x) * 4;\n\t\t\t\tconst pixels_original = value_img_data_original.data;\n\t\t\t\tvar pixels = value_img_data_opaque.data;\n\t\t\t\tif (pixels_original[index + 3] == obj_id) {\n\t\t\t\t\tpixels[index] = 0;\n\t\t\t\t\tpixels[index + 1] = 0;\n\t\t\t\t\tpixels[index + 2] = 0;\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\tpixels[index + 3] = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tvalue_img_opaque = imagedata_to_image (value_img_data_opaque);\n\t\tvalue_img_opaque.addEventListener('load', () => {\n\t\t\tclear_canvas();\n\t\t\tctx.drawing.clearRect(0, 0, width, height);\t\t\t\n\t\t\tconsole.log('erase_object: value_img_opaque loaded');\n\t\t\tdraw_cropped_image();\n\t\t});\n\n\t\treturn;\n\t};\n\n\tlet handle_drag_end = (e) => {\n\t\te.stopPropagation();\t\t//so that document:onmouseup won't fire again\n\t\te.preventDefault();\n\t\tif (!is_pressing) {\n\t\t\treturn;\n\t\t}\n\t\tis_pressing = false;\n\t\tmouse_has_moved = true;\n\t\tconst { x, y } = get_pointer_pos(e);\n\t\tconst drag_move_x = Math.round(x - drag_start_x);\n\t\tconst drag_move_y = Math.round(y - drag_start_y);\n\t\tconst draw_x = cropRect.left + drag_move_x;\n\t\tconst draw_y = cropRect.top + drag_move_y;\t\t\n\t\terase_object(current_object_id);\t\t\n\t\tchanged_objects.push({id: current_object_id, pos: {left: draw_x, top: draw_y, width: cropRect.width, height: cropRect.height}, img: cropped_image});\n\n\t\tdispatch(\"select\", { index: [drag_move_x, drag_move_y], value: current_object_id });\n\t\tconsole.log(\"handle_drag_end: dispatch (select)\")\n\t};\n\n\tlet old_width = 0;\n\tlet old_height = 0;\n\tlet old_container_height = 0;\n\tlet add_lr_border = false;\n\n\tlet handle_canvas_resize = async () => {\n\t\tif (shape && canvas_container) {\n\t\t\tconst x = canvas_container?.getBoundingClientRect();\n\t\t\tconst shape_ratio = shape[0] / shape[1];\n\t\t\tconst container_ratio = x.width / x.height;\n\t\t\tadd_lr_border = shape_ratio < container_ratio;\n\t\t}\n\n\t\tif (\n\t\t\twidth === old_width &&\n\t\t\theight === old_height &&\n\t\t\told_container_height === container_height\n\t\t) {\n\t\t\treturn;\n\t\t}\n\t\tconst dimensions = { width: width, height: height };\n\n\t\tconst container_dimensions = {\n\t\t\theight: container_height,\n\t\t\twidth: container_height * (dimensions.width / dimensions.height)\n\t\t};\n\n\t\tawait Promise.all([\n\t\t\tset_canvas_size(canvas.interface, dimensions, container_dimensions),\n\t\t\tset_canvas_size(canvas.drawing, dimensions, container_dimensions),\n\t\t\tset_canvas_size(canvas.temp, dimensions, container_dimensions),\n\t\t\tset_canvas_size(canvas.temp_fake, dimensions, container_dimensions),\n\t\t\tset_canvas_size(canvas.mask, dimensions, container_dimensions, false)\n\t\t]);\n\n\t\tif (!brush_radius) {\n\t\t\tbrush_radius = 20 * (dimensions.width / container_dimensions.width);\n\t\t}\n\n\t\tloop({ once: true });\n\n\t\tsetTimeout(() => {\n\t\t\told_height = height;\n\t\t\told_width = width;\n\t\t\told_container_height = container_height;\n\t\t}, 10);\n\t\tawait tick();\n\n\t\tclear();\n\t};\n\n\t$: {\n\t\tif (lazy) {\n\t\t\tinit();\n\t\t\tlazy.setRadius(brush_radius * 0.05);\n\t\t}\n\t}\n\n\t$: {\n\t\tif (width || height) {\n\t\t\thandle_canvas_resize();\n\t\t}\n\t}\n\n\tlet set_canvas_size = async (canvas, dimensions, container, scale = true) => {\n\t\tif (!mounted) return;\n\t\tawait tick();\n\n\t\tconst dpr = window.devicePixelRatio || 1;\n\t\tcanvas.width = dimensions.width * (scale ? dpr : 1);\n\t\tcanvas.height = dimensions.height * (scale ? dpr : 1);\n\n\t\tconst ctx = canvas.getContext(\"2d\");\n\t\tscale && ctx.scale(dpr, dpr);\n\n\t\tcanvas.style.width = `${container.width}px`;\n\t\tcanvas.style.height = `${container.height}px`;\n\t};\n\n\tlet get_pointer_pos = (e) => {\n\t\tconst rect = canvas.interface.getBoundingClientRect();\n\n\t\tlet clientX = e.clientX;\n\t\tlet clientY = e.clientY;\n\t\tif (e.changedTouches && e.changedTouches.length > 0) {\n\t\t\tclientX = e.changedTouches[0].clientX;\n\t\t\tclientY = e.changedTouches[0].clientY;\n\t\t}\n\n\t\treturn {\n\t\t\tx: ((clientX - rect.left) / rect.width) * width,\n\t\t\ty: ((clientY - rect.top) / rect.height) * height\n\t\t};\n\t};\n\n\tlet handle_pointer_move = (x, y) => {\n\t\tlazy.update({ x: x, y: y });\n\t\tconst is_disabled = !lazy.isEnabled();\n\t\tif ((is_pressing && !is_drawing) || (is_disabled && is_pressing)) {\n\t\t\tis_drawing = true;\n\t\t\tpoints.push(lazy.brush.toObject());\n\t\t}\n\t\tif (is_drawing) {\n\t\t\tpoints.push(lazy.brush.toObject());\t\t\t\n\t\t\tdraw_points({\n\t\t\t\tpoints: points,\n\t\t\t\tbrush_color,\n\t\t\t\tbrush_radius\n\t\t\t});\n\n\t\t\tif (mode === \"mask\") {\n\t\t\t\tdraw_fake_points({\n\t\t\t\t\tpoints: points,\n\t\t\t\t\tbrush_color,\n\t\t\t\t\tbrush_radius\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\tmouse_has_moved = true;\n\t};\n\n\tlet draw_points = ({ points, brush_color, brush_radius }) => {\n\t\tif (!points || points.length < 2) return;\n\n\t\tconsole.log(\"draw_points length\", points.length)\n\n\t\tctx.temp.lineJoin = \"round\";\n\t\tctx.temp.lineCap = \"round\";\n\n\t\tctx.temp.strokeStyle = brush_color;\n\t\tctx.temp.lineWidth = brush_radius;\n\t\tif (!points || points.length < 2) return;\n\n\t\tconsole.log(\"draw_points length\", points.length)\n\t\tlet p1 = points[0];\n\t\tlet p2 = points[1];\n\t\tctx.temp.moveTo(p2.x, p2.y);\n\t\tctx.temp.beginPath();\n\n\t\tfor (var i = 1, len = points.length; i < len; i++) {\n\t\t\tvar midPoint = mid_point(p1, p2);\n\t\t\tctx.temp.quadraticCurveTo(p1.x, p1.y, midPoint.x, midPoint.y);\n\t\t\tp1 = points[i];\n\t\t\tp2 = points[i + 1];\n\t\t}\n\t\t/*\n\t\tctx.temp.lineTo(p1.x, p1.y);\n\n\t\tctx.temp.stroke();\n\t\t*/\n\t\t//draw a rectangle instead\n\t\tctx.temp.strokeStyle = 'red';\n\t\tctx.temp.lineWidth = 5;\n\t\tctx.temp.strokeRect(p1.x, p1.y, 50, 50);\n\t\tconsole.log('drawing rect at ', p1.x, p1.y);\n\t};\n\n\tlet draw_fake_points = ({ points, brush_color, brush_radius }) => {\n\t\tif (!points || points.length < 2) return;\n\n\t\tctx.temp_fake.lineJoin = \"round\";\n\t\tctx.temp_fake.lineCap = \"round\";\n\t\tctx.temp_fake.strokeStyle = \"#fff\";\n\t\tctx.temp_fake.lineWidth = brush_radius;\n\t\tlet p1 = points[0];\n\t\tlet p2 = points[1];\n\t\tctx.temp_fake.moveTo(p2.x, p2.y);\n\t\tctx.temp_fake.beginPath();\n\n\t\t\n\t\tfor (var i = 1, len = points.length; i < len; i++) {\n\t\t\tvar midPoint = mid_point(p1, p2);\n\t\t\tctx.temp_fake.quadraticCurveTo(p1.x, p1.y, midPoint.x, midPoint.y);\n\t\t\tp1 = points[i];\n\t\t\tp2 = points[i + 1];\n\t\t}\n\t\t/*\n\t\tctx.temp_fake.lineTo(p1.x, p1.y);\n\t\tctx.temp_fake.stroke();\n\t\t*/\n\t\t//draw a rectangle instead\n\t\tctx.temp_fake.strokeStyle = 'red';\n\t\tctx.temp_fake.lineWidth = 5;\n\t\tctx.temp_fake.strokeRect(p1.x, p1.y, 50, 50);\n\t\tconsole.log('drawing rect at ', p1.x, p1.y);\t\t\n\t};\n\n\tlet save_mask_line = () => {\n\t\tif (points.length < 1) return;\n\t\tpoints.length = 0;\n\t\tctx.mask.drawImage(canvas.temp_fake, 0, 0, width, height);\n\n\t\ttrigger_on_change('save_mask_line');\n\t};\n\n\tlet saveLine = () => {\n\t\tif (points.length < 1) return;\n\n\t\tlines.push({\n\t\t\tpoints: points.slice(),\n\t\t\tbrush_color: brush_color,\n\t\t\tbrush_radius\n\t\t});\n\n\t\tif (mode !== \"mask\") {\n\t\t\tpoints.length = 0;\n\t\t}\n\n\t\tctx.drawing.drawImage(canvas.temp, 0, 0, width, height);\n\n\t\ttrigger_on_change('saveLine');\n\t};\n\n\tlet trigger_on_change = (source) => {\n\t\tconsole.log(`trigger_on_change called from ${source}`);\n\t\tconst x = get_image_data();\n\t\tdispatch(\"change\", x);\n\t};\n\n\texport function clear() {\n\t\tlines = [];\n\t\tclear_canvas();\n\t\tline_count = 0;\n\n\t\treturn true;\n\t}\n\n\tfunction clear_canvas() {\n\t\tvalues_changed = true;\n\t\tctx.temp.clearRect(0, 0, width, height);\n\n\t\tctx.temp.fillStyle = mode === \"mask\" ? \"transparent\" : \"#FFFFFF\";\n\t\tctx.temp.fillRect(0, 0, width, height);\n\n\t\tif (mode === \"mask\") {\n\t\t\tctx.temp_fake.clearRect(\n\t\t\t\t0,\n\t\t\t\t0,\n\t\t\t\tcanvas.temp_fake.width,\n\t\t\t\tcanvas.temp_fake.height\n\t\t\t);\n\t\t\tctx.mask.clearRect(0, 0, width, height);\n\t\t\tctx.mask.fillStyle = \"#000\";\n\t\t\tctx.mask.fillRect(0, 0, width, height);\n\t\t}\n\t}\n\n\tlet loop = ({ once = false } = {}) => {\n\t\tif (mouse_has_moved || values_changed) {\n\t\t\tconst pointer = lazy.getPointerCoordinates();\n\t\t\tconst brush = lazy.getBrushCoordinates();\n//\t\t\tdraw_interface(ctx.interface, pointer, brush);\n\t\t\tmouse_has_moved = false;\n\t\t\tvalues_changed = false;\n\t\t}\n\t\tif (!once) {\n\t\t\twindow.requestAnimationFrame(() => {\n\t\t\t\tloop();\n\t\t\t});\n\t\t}\n\t};\n\n\t$: brush_dot = brush_radius * 0.075;\n\n\tlet draw_interface = (ctx, pointer, brush) => {\n\t\tctx.clearRect(0, 0, width, height);\n\n\t\t// brush preview\n\t\t/*\n\t\tctx.beginPath();\n\t\tctx.fillStyle = brush_color;\n\t\tctx.arc(brush.x, brush.y, brush_radius / 2, 0, Math.PI * 2, true);\n\t\tctx.fill();\n\n\t\t// tiny brush point dot\n\t\tctx.beginPath();\n\t\tctx.fillStyle = catenary_color;\n\t\tctx.arc(brush.x, brush.y, brush_dot, 0, Math.PI * 2, true);\n\t\tctx.fill();\n\t\t*/\n\t};\n\n\texport function get_image_data() {\n\t\treturn mode === \"mask\"\n\t\t\t? canvas.mask.toDataURL(\"image/jpg\")\n\t\t\t: canvas.drawing.toDataURL(\"image/jpg\");\n\t}\n</script>\n\n<div\n\tclass=\"wrap\"\n\tbind:this={canvas_container}\n\tbind:offsetWidth={canvas_width}\n\tbind:offsetHeight={canvas_height}\n>\n\t{#if line_count === 0}\n\t\t<div transition:fade={{ duration: 50 }} class=\"start-prompt\">\n\t\t\tStart drawing\n\t\t</div>\n\t{/if}\n\t{#each canvas_types as { name, zIndex }}\n\t\t<canvas\n\t\t\tkey={name}\n\t\t\tstyle=\" z-index:{zIndex};\"\n\t\t\tclass:lr={add_lr_border}\n\t\t\tclass:tb={!add_lr_border}\n\t\t\tbind:this={canvas[name]}\n\t\t\ton:mousedown={\n\t\t\t\tname === \"interface\" ? handle_draw_start : \n\t\t\t\tname === \"drawing\" ? handle_drag_start : \n\t\t\t\tundefined\n\t\t\t}\n\t\t\ton:mousemove={\n\t\t\t\tname === \"interface\" ? handle_draw_move : \n\t\t\t\tname === \"drawing\" ? handle_drag_move : \n\t\t\t\tundefined\n\t\t\t}\n\t\t\ton:mouseup={\n\t\t\t\tname === \"interface\" ? handle_draw_end : \n\t\t\t\tname === \"drawing\" ? handle_drag_end : \n\t\t\t\tundefined\n\t\t\t}\n\t\t\ton:blur={name === \"interface\" ? handle_draw_end : undefined}\n\t\t\ton:touchstart={name === \"interface\" ? handle_draw_start : undefined}\n\t\t\ton:touchmove={name === \"interface\" ? handle_draw_move : undefined}\n\t\t\ton:touchend={name === \"interface\" ? handle_draw_end : undefined}\n\t\t\ton:touchcancel={name === \"interface\" ? handle_draw_end : undefined}\n\t\t\ton:click|stopPropagation\n\t\t/>\n\t{/each}\n</div>\n\n<style>\n\tcanvas {\n\t\tdisplay: block;\n\t\tposition: absolute;\n\t\ttop: 0px;\n\t\tright: 0px;\n\t\tbottom: 0px;\n\t\tleft: 0px;\n\t\tmargin: auto;\n\t}\n\n\t.lr {\n\t\tborder-right: 1px solid var(--border-color-primary);\n\t\tborder-left: 1px solid var(--border-color-primary);\n\t}\n\n\t.tb {\n\t\tborder-top: 1px solid var(--border-color-primary);\n\t\tborder-bottom: 1px solid var(--border-color-primary);\n\t}\n\n\tcanvas:hover {\n\t\tcursor: crosshair;\n\t}\n\n\t.wrap {\n\t\tposition: relative;\n\t\twidth: var(--size-full);\n\t\theight: var(--size-full);\n\t\ttouch-action: none;\n\t}\n\n\t.start-prompt {\n\t\tdisplay: flex;\n\t\tposition: absolute;\n\t\ttop: 0px;\n\t\tright: 0px;\n\t\tbottom: 0px;\n\t\tleft: 0px;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\tz-index: var(--layer-4);\n\t\ttouch-action: none;\n\t\tpointer-events: none;\n\t\tcolor: var(--body-text-color-subdued);\n\t}\n</style>\n","<script lang=\"ts\">\n\timport { createEventDispatcher } from \"svelte\";\n\timport { IconButton } from \"@gradio/atoms\";\n\timport { Undo, Clear, Erase } from \"@gradio/icons\";\n\n\tconst dispatch = createEventDispatcher();\n\n\texport let show_eraser: boolean = false;\n</script>\n\n<div>\n\t<IconButton Icon={Undo} label=\"Undo\" on:click={() => dispatch(\"undo\")} />\n\n\t{#if show_eraser}\n\t\t<IconButton\n\t\t\tIcon={Erase}\n\t\t\tlabel=\"Clear\"\n\t\t\ton:click={(event) => {\n\t\t\t\tdispatch(\"clear_mask\");\n\t\t\t\tevent.stopPropagation();\n\t\t\t}}\n\t\t/>\n\t{/if}\n\n\t<IconButton\n\t\tIcon={Clear}\n\t\tlabel=\"Remove Image\"\n\t\ton:click={(event) => {\n\t\t\tdispatch(\"remove_image\");\n\t\t\tevent.stopPropagation();\n\t\t}}\n\t/>\n</div>\n\n<style>\n\tdiv {\n\t\tdisplay: flex;\n\t\tposition: absolute;\n\t\ttop: var(--size-2);\n\t\tright: var(--size-2);\n\t\tjustify-content: flex-end;\n\t\tgap: var(--spacing-sm);\n\t\tz-index: var(--layer-5);\n\t}\n</style>\n","<script lang=\"ts\">\n\timport { createEventDispatcher } from \"svelte\";\n\timport { IconButton } from \"@gradio/atoms\";\n\timport { Brush, Color } from \"@gradio/icons\";\n\n\tconst dispatch = createEventDispatcher();\n\n\tlet show_size = false;\n\tlet show_col = false;\n\n\texport let brush_radius = 20;\n\texport let brush_color = \"#000\";\n\texport let container_height: number;\n\texport let img_width: number;\n\texport let img_height: number;\n\texport let mode: \"mask\" | \"other\" = \"other\";\n\texport let tool: \"compose\" | \"others\" = \"others\";\n\n\t$: width = container_height * (img_width / img_height);\n</script>\n\n<div class=\"wrap\">\n\t{#if tool !== \"compose\"}\n\t\t<span class=\"brush\">\n\t\t\t<IconButton\n\t\t\t\tIcon={Brush}\n\t\t\t\tlabel=\"Use brush\"\n\t\t\t\ton:click={() => (show_size = !show_size)}\n\t\t\t/>\n\t\t\t{#if show_size}\n\t\t\t\t<input\n\t\t\t\t\taria-label=\"Brush radius\"\n\t\t\t\t\tbind:value={brush_radius}\n\t\t\t\t\ttype=\"range\"\n\t\t\t\t\tmin={0.5 * (img_width / width)}\n\t\t\t\t\tmax={75 * (img_width / width)}\n\t\t\t\t/>\n\t\t\t{/if}\n\t\t</span>\n\n\t\t{#if mode !== \"mask\"}\n\t\t\t<span class=\"col\">\n\t\t\t\t<IconButton\n\t\t\t\t\tIcon={Color}\n\t\t\t\t\tlabel=\"Select brush color\"\n\t\t\t\t\ton:click={() => (show_col = !show_col)}\n\t\t\t\t/>\n\t\t\t\t{#if show_col}\n\t\t\t\t\t<input aria-label=\"Brush color\" bind:value={brush_color} type=\"color\" />\n\t\t\t\t{/if}\n\t\t\t</span>\t\t\t\n\t\t{/if}\n\t{/if}\t\t\n</div>\n\n<style>\n\t.wrap {\n\t\tdisplay: flex;\n\t\tposition: absolute;\n\t\ttop: var(--size-10);\n\t\tright: var(--size-2);\n\t\tflex-direction: column;\n\t\tjustify-content: flex-end;\n\t\tgap: var(--spacing-sm);\n\t\tz-index: var(--layer-5);\n\t}\n\t.brush {\n\t\ttop: 0;\n\t\tright: 0;\n\t}\n\n\t.brush input {\n\t\tposition: absolute;\n\t\ttop: 3px;\n\t\tright: calc(100% + 5px);\n\t}\n\n\t.col input {\n\t\tposition: absolute;\n\t\tright: calc(100% + 5px);\n\t\tbottom: -4px;\n\t}\n</style>\n","<script lang=\"ts\">\n\t// @ts-nocheck\n\timport { createEventDispatcher, tick, onMount } from \"svelte\";\n\timport { BlockLabel } from \"@gradio/atoms\";\n\timport { Image, Sketch as SketchIcon } from \"@gradio/icons\";\n\timport type { SelectData } from \"@gradio/utils\";\n\timport { get_coordinates_of_clicked_image } from \"./utils\";\n\n\timport Cropper from \"./Cropper.svelte\";\n\timport Sketch from \"./Sketch.svelte\";\n\timport Compose from \"./Compose.svelte\";\n\timport Webcam from \"./Webcam.svelte\";\n\timport ModifySketch from \"./ModifySketch.svelte\";\n\timport SketchSettings from \"./SketchSettings.svelte\";\n\n\timport { Upload, ModifyUpload } from \"@gradio/upload\";\n\n\texport let value:\n\t\t| null\n\t\t| string\n\t\t| { image: string | null; mask: string | null };\n\texport let label: string | undefined = undefined;\n\texport let show_label: boolean;\n\n\texport let source: \"canvas\" | \"webcam\" | \"upload\" = \"upload\";\n\texport let tool: \"editor\" | \"select\" | \"sketch\" | \"color-sketch\" = \"editor\" | \"compose\";\n\texport let shape: [number, number];\n\texport let streaming: boolean = false;\n\texport let pending: boolean = false;\n\texport let mirror_webcam: boolean;\n\texport let brush_radius: number;\n\texport let selectable: boolean = false;\n\n\tlet sketch: Sketch;\n\tlet compose: Compose;\n\tlet cropper: Cropper;\n\n\tif (\n\t\tvalue &&\n\t\t(source === \"upload\" || source === \"webcam\") &&\n\t\t(tool === \"sketch\" || tool === \"compose\")\n\t) {\n\t\tvalue = { image: value as string, mask: null };\n\t}\n\n\tfunction handle_upload({ detail }: CustomEvent<string>) {\n\n\t\tconsole.log(\"handle_upload container_height:\", container_height);\n\t\tconsole.log(\"handle_upload max_height:\", max_height);\n\n\t\tif (tool === \"color-sketch\") {\n\t\t\tstatic_image = detail;\n\t\t} else {\n\t\t\tvalue =\n\t\t\t\t(source === \"upload\" || source === \"webcam\") && (tool === \"sketch\" || tool === \"compose\")\n\t\t\t\t\t? { image: detail, mask: null }\n\t\t\t\t\t: detail;\n\t\t}\n\t\tdispatch(\"upload\", detail);\n\t}\n\n\tfunction handle_clear({ detail }: CustomEvent<null>) {\n\t\tvalue = null;\n\t\tstatic_image = undefined;\n\t\tdispatch(\"clear\");\n\t}\n\n\tasync function handle_save({ detail }: { detail: string }, initial) {\n\t\tif (mode === \"mask\") {\n\t\t\tif (source === \"webcam\" && initial) {\n\t\t\t\tvalue = {\n\t\t\t\t\timage: detail,\n\t\t\t\t\tmask: null\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tvalue = {\n\t\t\t\t\timage: typeof value === \"string\" ? value : value?.image || null,\n\t\t\t\t\tmask: detail\n\t\t\t\t};\n\t\t\t}\n\t\t} else if (\n\t\t\t(source === \"upload\" || source === \"webcam\") &&\n\t\t\t(tool === \"sketch\" || tool === \"compose\")\n\t\t) {\n\t\t\tvalue = { image: detail, mask: null };\n\t\t} else {\n\t\t\tvalue = detail;\n\t\t}\n\n\t\tawait tick();\n\n\t\tdispatch(streaming ? \"stream\" : \"edit\");\n\t\tconsole.log(\"image.svelte handle_save source =\", source, \"value:\", value);\n\t}\n\n\tasync function handle_select({ detail }: { detail: SelectData }) {\n\t\tawait tick();\n\t\tdispatch(\"select\", detail);\n\t\tconsole.log(\"image.svelte handle_select source =\", source, \"detail:\", detail);\n\t}\n\n\tconst dispatch = createEventDispatcher<{\n\t\tchange: string | null;\n\t\tstream: string | null;\n\t\tedit: undefined;\n\t\tclear: undefined;\n\t\tdrag: boolean;\n\t\tupload: FileData;\n\t\tselect: SelectData;\n\t\tselection_move: SelectData;\n\t}>();\n\n\t$: dispatch(\"change\", value as string);\n\n\tlet dragging = false;\n\n\t$: dispatch(\"drag\", dragging);\n\n\tfunction handle_image_load(event: Event) {\n\t\tconst element = event.currentTarget as HTMLImageElement;\n\t\timg_width = element.naturalWidth;\n\t\timg_height = element.naturalHeight;\n\t\tcontainer_height = element.getBoundingClientRect().height;\n\n\t\tconsole.log(\"image.svelte handle_image_load source:\", source);\n\t\tconsole.log(\"image.svelte handle_image_load tool:\", tool);\t\t\n\t\tconsole.log(\"image.svelte handle_image_load img_width:\", img_width);\n\t\tconsole.log(\"image.svelte handle_image_load img_height:\", img_height);\t\n\t\tconsole.log(\"image.svelte handle_image_load container_height:\", container_height);\n\t\tconsole.log(event);\n\t\tconsole.log(element);\n\t}\n\n\tasync function handle_sketch_clear() {\n\t\tsketch.clear();\n\t\tawait tick();\n\t\tvalue = null;\n\t\tstatic_image = undefined;\n\t}\n\n\tasync function handle_mask_clear() {\n\t\tsketch.clear_mask();\n\t\tawait tick();\n\t}\n\n\tlet img_height = 0;\n\tlet img_width = 0;\n\tlet container_height = 0;\n\n\tlet mode;\n\n\t$: {\n\t\tif (source === \"canvas\" && (tool === \"sketch\" || tool === \"compose\") ) {\n\t\t\tmode = \"bw-sketch\";\n\t\t} else if (tool === \"color-sketch\") {\n\t\t\tmode = \"color-sketch\";\n\t\t} else if (\n\t\t\t(source === \"upload\" || source === \"webcam\") &&\n\t\t\t(tool === \"sketch\" || tool === \"compose\")\n\t\t) {\n\t\t\tmode = \"mask\";\n\t\t} else {\n\t\t\tmode = \"editor\";\n\t\t}\n\t}\n\n\t$: brush_color = mode == \"mask\" ? \"#000000\" : \"#000\";\n\n\tlet value_img;\n\tlet max_height;\n\tlet max_width;\n\n\tlet static_image = undefined;\n\n\t$: {\n\t\tif (value === null || (value.image === null && value.mask === null)) {\n\t\t\tstatic_image = undefined;\n\t\t}\n\t}\n\n\t$: {\n\t\tif (cropper) {\n\t\t\tif (value) {\n\t\t\t\tcropper.image = value;\n\t\t\t\tcropper.create();\n\t\t\t} else {\n\t\t\t\tcropper.destroy();\n\t\t\t}\n\t\t}\n\t}\n\n\t$: {\n\t\tconsole.log(\"image.svelte source:\", source);\n\t\tconsole.log(\"image.svelte tool:\", tool);\n\t\tconsole.log(\"image.svelte mode:\", mode);\n\t\tconsole.log(\"image.svelte container_height:\", container_height);\n\t\tconsole.log(\"image.svelte max_height:\", max_height);\n\t}\n\n\tonMount(async () => {\n\t\tconsole.log(\"image.svelte onMount source:\", source);\n\t\tconsole.log(\"image.svelte onMount tool:\", tool);\t\t\n\t\tconsole.log(\"onMount container_height:\", container_height);\n\t\tconsole.log(\"onMount max_height:\", max_height);\n\t\tif (tool === \"color-sketch\" && value && typeof value === \"string\") {\n\t\t\tstatic_image = value;\n\t\t\tawait tick();\n\t\t\t({ currentTarget: value_img });\n\t\t} \n\t});\n\n\t$: { \t\n\t\tconsole.log(\"container_height:\", container_height);\n\t\tconsole.log(\"max_height:\", max_height);\n\t}\n\n\tconst handle_click = (evt: MouseEvent) => {\n\t\tlet coordinates = get_coordinates_of_clicked_image(evt);\n\t\tif (coordinates) {\n\t\t\tdispatch(\"select\", { index: coordinates, value: null });\n\t\t}\n\t};\n\n\tlet startCoordinates;\n\tlet mousePressed;\n\n\tconst handle_move_start = (evt: MouseEvent) => {\n\t\tmousePressed = true;\n\t\tstartCoordinates = get_coordinates_of_clicked_image(evt);\n\t\tconsole.log('mousePressed');\n\n\t\tconst image = evt.currentTarget as HTMLImageElement;\n\t\tconsole.log(image);\n\t\t//const canvas = document.getElementById(\"select_image\") as HTMLCanvasElement;\n\t\tconsole.log(image.width, image.height);\n\t\tconsole.log(image instanceof HTMLImageElement)\n\t\tconst ctx = image.getContext(\"2d\");\n\n\t\tctx.fillStyle = \"red\";\n  \t \tctx.fillRect(startCoordinates[0], startCoordinates[1], 100, 100);\n\t};\n\n\tlet mouseMoved;\n\tconst handle_move = (evt: MouseEvent) => {\t\t\n\t\tif (mousePressed) {\n\t\t\tmouseMoved = true;\n\t\t\tconsole.log('mouseMoved');\n\t\t}\n\t};\n\n\tconst handle_move_end = (evt: MouseEvent) => {\n\t\tif (mousePressed && mouseMoved) {\n\t\t\tmousePressed = false;\n\t\t\tmouseMoved = false;\n\t\t\tlet endCoordinates = get_coordinates_of_clicked_image(evt);\n\t\t\tlet offsetX = endCoordinates[0] - startCoordinates[0];\n\t\t\tlet offsetY = endCoordinates[1] - startCoordinates[1];\n\t\t\tlet offset = [offsetX, offsetY];\t\t\t\n//\t\t\tdispatch(\"selection_move\", { index: offset, value: null });\n\t\t\tdispatch(\"select\", { index: startCoordinates, value: offset });\n\t\t\tconsole.log('mouseReleased');\t\t\t\n\t\t}\n\t};\n\n\t\n</script>\n\n<BlockLabel\n\t{show_label}\n\tIcon={source === \"canvas\" ? SketchIcon : Image}\n\tlabel={label || (source === \"canvas\" ? \"Sketch\" : \"Image\")}\n/>\n\n<div\n\tdata-testid=\"image\"\n\tclass=\"image-container\"\n\tbind:offsetHeight={max_height}\n\tbind:offsetWidth={max_width}\n>\n\t{#if source === \"upload\"}\n\t\t<Upload\n\t\t\tbind:dragging\n\t\t\tfiletype=\"image/*\"\n\t\t\ton:load={handle_upload}\n\t\t\tinclude_file_metadata={false}\n\t\t\tdisable_click={!!value}\n\t\t>\n\t\t\t{#if (value === null && !static_image) || streaming}\n\t\t\t\t<slot />\n\t\t\t{:else if tool === \"select\"}\n\t\t\t\t<Cropper bind:this={cropper} image={value} on:crop={handle_save} />\n\t\t\t\t<ModifyUpload on:clear={(e) => (handle_clear(e), (tool = \"editor\"))} />\n\t\t\t{:else if tool === \"editor\"}\n\t\t\t\t<ModifyUpload\n\t\t\t\t\ton:edit={() => (tool = \"select\")}\n\t\t\t\t\ton:clear={handle_clear}\n\t\t\t\t\teditable\n\t\t\t\t/>\n\n\t\t\t\t<!-- svelte-ignore a11y-click-events-have-key-events -->\n\t\t\t\t<img\n\t\t\t\t\tsrc={value}\n\t\t\t\t\talt=\"\"\n\t\t\t\t\tclass:scale-x-[-1]={source === \"webcam\" && mirror_webcam}\n\t\t\t\t\tclass:selectable\n\t\t\t\t\ton:click={handle_click}\n\t\t\t\t\t/>\n\t\t\t{:else if ((tool === \"sketch\" || tool === \"compose\") || tool === \"color-sketch\") && (value !== null || static_image)}\n\t\t\t\t{#key static_image}\n\t\t\t\t\t<img\n\t\t\t\t\t\tbind:this={value_img}\n\t\t\t\t\t\tclass=\"absolute-img\"\n\t\t\t\t\t\tsrc={static_image || value?.image || value}\n\t\t\t\t\t\talt=\"\"\n\t\t\t\t\t\ton:load={handle_image_load}\n\t\t\t\t\t\tclass:webcam={source === \"webcam\" && mirror_webcam}\n\t\t\t\t\t/>\n\t\t\t\t{/key}\n\t\t\t\t{#if img_width > 0}\n\t\t\t\t\t{#if tool === \"compose\"}\n\t\t\t\t\t\t<Compose\n\t\t\t\t\t\t\t{value}\n\t\t\t\t\t\t\tbind:this={compose}\n\t\t\t\t\t\t\tbind:brush_radius\n\t\t\t\t\t\t\tbind:brush_color\n\t\t\t\t\t\t\ton:change={handle_save}\n\t\t\t\t\t\t\ton:select={handle_select}\n\t\t\t\t\t\t\t{mode}\n\t\t\t\t\t\t\twidth={img_width || max_width}\n\t\t\t\t\t\t\theight={img_height || max_height}\n\t\t\t\t\t\t\tcontainer_height={container_height || max_height}\n\t\t\t\t\t\t\t{value_img}\n\t\t\t\t\t\t\t{source}\n\t\t\t\t\t\t\t{shape}\n\t\t\t\t\t\t/>\n\t\t\t\t\t{:else}\n\t\t\t\t\t\t<Sketch\n\t\t\t\t\t\t\t{value}\n\t\t\t\t\t\t\tbind:this={sketch}\n\t\t\t\t\t\t\tbind:brush_radius\n\t\t\t\t\t\t\tbind:brush_color\n\t\t\t\t\t\t\ton:change={handle_save}\n\t\t\t\t\t\t\ton:select={handle_select}\n\t\t\t\t\t\t\t{mode}\n\t\t\t\t\t\t\twidth={img_width || max_width}\n\t\t\t\t\t\t\theight={img_height || max_height}\n\t\t\t\t\t\t\tcontainer_height={container_height || max_height}\n\t\t\t\t\t\t\t{value_img}\n\t\t\t\t\t\t\t{source}\n\t\t\t\t\t\t\t{shape}\n\t\t\t\t\t\t/>\n\t\t\t\t\t{/if}\n\t\t\t\t\t<ModifySketch\n\t\t\t\t\t\tshow_eraser={value_img}\n\t\t\t\t\t\ton:undo={() => sketch.undo()}\n\t\t\t\t\t\ton:clear_mask={handle_mask_clear}\n\t\t\t\t\t\ton:remove_image={handle_sketch_clear}\n\t\t\t\t\t/>\n\t\t\t\t\t{#if tool === \"color-sketch\" || (tool === \"sketch\" || tool === \"compose\")}\n\t\t\t\t\t\t<SketchSettings\n\t\t\t\t\t\t\tbind:brush_radius\n\t\t\t\t\t\t\tbind:brush_color\n\t\t\t\t\t\t\tcontainer_height={container_height || max_height}\n\t\t\t\t\t\t\timg_width={img_width || max_width}\n\t\t\t\t\t\t\timg_height={img_height || max_height}\n\t\t\t\t\t\t\t{mode}\n\t\t\t\t\t\t\t{tool}\n\t\t\t\t\t\t/>\n\t\t\t\t\t{/if}\n\t\t\t\t{/if}\n\t\t\t{:else}\n\t\t\t\t<!-- svelte-ignore a11y-click-events-have-key-events -->\n\t\t\t\t<img\n\t\t\t\t\tsrc={value.image || value}\n\t\t\t\t\talt=\"hello\"\n\t\t\t\t\tclass:webcam={source === \"webcam\" && mirror_webcam}\n\t\t\t\t\tclass:selectable\n\t\t\t\t\ton:click={handle_click}\n\t\t\t\t/>\n\t\t\t{/if}\n\t\t</Upload>\n\t\n\t\t{:else if source === \"canvas\"}\n\t\t<ModifySketch\n\t\t\ton:undo={() => sketch.undo()}\n\t\t\ton:remove_image={handle_sketch_clear}\n\t\t/>\n\t\t{#if tool === \"color-sketch\"}\n\t\t\t<SketchSettings\n\t\t\t\tbind:brush_radius\n\t\t\t\tbind:brush_color\n\t\t\t\tcontainer_height={container_height || max_height}\n\t\t\t\timg_width={img_width || max_width}\n\t\t\t\timg_height={img_height || max_height}\n\t\t\t/>\n\t\t{/if}\n\t\t<Sketch\n\t\t\t{value}\n\t\t\tbind:brush_radius\n\t\t\tbind:brush_color\n\t\t\tbind:this={sketch}\n\t\t\ton:change={handle_save}\n\t\t\ton:clear={handle_sketch_clear}\n\t\t\t{mode}\n\t\t\twidth={img_width || max_width}\n\t\t\theight={img_height || max_height}\n\t\t\tcontainer_height={container_height || max_height}\n\t\t\t{shape}\n\t\t/>\n\t\t<Compose\n\t\t\t{value}\n\t\t\tbind:brush_radius\n\t\t\tbind:brush_color\n\t\t\tbind:this={compose}\n\t\t\ton:change={handle_save}\n\t\t\ton:clear={handle_sketch_clear}\n\t\t\t{mode}\n\t\t\twidth={img_width || max_width}\n\t\t\theight={img_height || max_height}\n\t\t\tcontainer_height={container_height || max_height}\n\t\t\t{shape}\n\t\t/>\n\t{:else if (value === null && !static_image) || streaming}\n\t\t{#if source === \"webcam\" && !static_image}\n\t\t\t<Webcam\n\t\t\t\ton:capture={(e) =>\n\t\t\t\t\ttool === \"color-sketch\" ? handle_upload(e) : handle_save(e, true)}\n\t\t\t\ton:stream={handle_save}\n\t\t\t\ton:error\n\t\t\t\t{streaming}\n\t\t\t\t{pending}\n\t\t\t\t{mirror_webcam}\n\t\t\t/>\n\t\t{/if}\n\t{:else if tool === \"select\"}\n\t\t<Cropper bind:this={cropper} image={value} on:crop={handle_save} />\n\t\t<ModifyUpload on:clear={(e) => (handle_clear(e), (tool = \"editor\"))} />\n\t{:else if tool === \"editor\"}\n\t\t<ModifyUpload\n\t\t\ton:edit={() => (tool = \"select\")}\n\t\t\ton:clear={handle_clear}\n\t\t\teditable\n\t\t/>\n\n\t\t<!-- svelte-ignore a11y-click-events-have-key-events -->\n\t\t<img\n\t\t\tsrc={value}\n\t\t\talt=\"\"\n\t\t\tclass:selectable\n\t\t\tclass:webcam={source === \"webcam\" && mirror_webcam}\n\t\t\ton:click={handle_click}\n\t\t/>\n\t{:else if ((tool === \"sketch\" || tool === \"compose\") || tool === \"color-sketch\") && (value !== null || static_image)}\n\t\t{#key static_image}\n\t\t\t<img\n\t\t\t\tbind:this={value_img}\n\t\t\t\tclass=\"absolute-img\"\n\t\t\t\tsrc={static_image || value?.image || value}\n\t\t\t\talt=\"\"\n\t\t\t\ton:load={handle_image_load}\n\t\t\t\tclass:webcam={source === \"webcam\" && mirror_webcam}\n\t\t\t/>\n\t\t{/key}\n\t\t{#if img_width > 0}\n\t\t\t<Sketch\n\t\t\t\t{value}\n\t\t\t\tbind:this={sketch}\n\t\t\t\tbind:brush_radius\n\t\t\t\tbind:brush_color\n\t\t\t\ton:change={handle_save}\n\t\t\t\t{mode}\n\t\t\t\twidth={img_width || max_width}\n\t\t\t\theight={img_height || max_height}\n\t\t\t\tcontainer_height={container_height || max_height}\n\t\t\t\t{value_img}\n\t\t\t\t{source}\n\t\t\t/>\n\t\t\t<ModifySketch\n\t\t\t\ton:undo={() => sketch.undo()}\n\t\t\t\ton:remove_image={handle_sketch_clear}\n\t\t\t/>\n\t\t\t{#if tool === \"color-sketch\" || (tool === \"sketch\" || tool === \"compose\")}\n\t\t\t\t<SketchSettings\n\t\t\t\t\tbind:brush_radius\n\t\t\t\t\tbind:brush_color\n\t\t\t\t\tcontainer_height={container_height || max_height}\n\t\t\t\t\timg_width={img_width || max_width}\n\t\t\t\t\timg_height={img_height || max_height}\n\t\t\t\t\t{mode}\n\t\t\t\t/>\n\t\t\t{/if}\n\t\t{/if}\n\t{:else}\n\t\t<!-- svelte-ignore a11y-click-events-have-key-events -->\n\t\t<img\n\t\t\tsrc={value.image || value}\n\t\t\talt=\"\"\n\t\t\tclass:webcam={source === \"webcam\" && mirror_webcam}\n\t\t\tclass:selectable\n\t\t\ton:click={handle_click}\n\t\t/>\n\t{/if}\n</div>\n\n<style>\n\t.image-container,\n\timg {\n\t\twidth: var(--size-full);\n\t\theight: var(--size-full);\n\t}\n\timg {\n\t\tobject-fit: contain;\n\t}\n\n\t.selectable {\n\t\tcursor: crosshair;\n\t}\n\n\t.absolute-img {\n\t\tposition: absolute;\n\t\topacity: 0;\n\t}\n\n\t.webcam {\n\t\ttransform: scaleX(-1);\n\t}\n</style>\n","<script lang=\"ts\">\n\timport { createEventDispatcher } from \"svelte\";\n\timport { Image, StaticImage } from \"@gradio/image\";\n\timport { Block } from \"@gradio/atoms\";\n\timport { _ } from \"svelte-i18n\";\n\timport { Component as StatusTracker } from \"../StatusTracker/\";\n\timport type { LoadingStatus } from \"../StatusTracker/types\";\n\timport UploadText from \"../UploadText.svelte\";\n\n\texport let elem_id: string = \"\";\n\texport let elem_classes: Array<string> = [];\n\texport let visible: boolean = true;\n\texport let value: null | string = null;\n\texport let source: \"canvas\" | \"webcam\" | \"upload\" = \"upload\";\n\texport let tool: \"editor\" | \"select\" | \"sketch\" | \"color-sketch\" = \"editor\";\n\texport let label: string;\n\texport let show_label: boolean;\n\texport let streaming: boolean;\n\texport let pending: boolean;\n\texport let height: number | undefined;\n\texport let width: number | undefined;\n\texport let mirror_webcam: boolean;\n\texport let shape: [number, number];\n\texport let brush_radius: number;\n\texport let selectable: boolean = false;\n\texport let container: boolean = false;\n\texport let scale: number = 1;\n\texport let min_width: number | undefined = undefined;\n\texport let loading_status: LoadingStatus;\n\texport let mode: \"static\" | \"dynamic\";\n\n\tconst dispatch = createEventDispatcher<{\n\t\tchange: undefined;\n\t}>();\n\n\t$: value, dispatch(\"change\");\n\tlet dragging: boolean;\n\tconst FIXED_HEIGHT = 240;\n\n\t$: value = !value ? null : value;\n</script>\n\n<Block\n\t{visible}\n\tvariant={mode === \"dynamic\" && value === null && source === \"upload\"\n\t\t? \"dashed\"\n\t\t: \"solid\"}\n\tborder_mode={dragging ? \"focus\" : \"base\"}\n\tpadding={false}\n\t{elem_id}\n\t{elem_classes}\n\theight={height ||\n\t\t(source === \"webcam\" || mode === \"static\" ? undefined : FIXED_HEIGHT)}\n\t{width}\n\tallow_overflow={false}\n\t{container}\n\t{scale}\n\t{min_width}\n>\n\t<StatusTracker {...loading_status} />\n\t{#if mode === \"static\"}\n\t\t<!-- <StaticImage on:select {value} {label} {show_label} {selectable} /> -->\n\t\t<Image\n\t\t{brush_radius}\n\t\t{shape}\n\t\tbind:value\n\t\t{source}\n\t\t{tool}\n\t\t{selectable}\n\t\ton:edit\n\t\ton:clear\n\t\ton:change\n\t\ton:stream\n\t\ton:drag={({ detail }) => (dragging = detail)}\n\t\ton:upload\n\t\ton:select\n\t\ton:error={({ detail }) => {\n\t\t\tloading_status = loading_status || {};\n\t\t\tloading_status.status = \"error\";\n\t\t\tloading_status.message = detail;\n\t\t}}\n\t\t{label}\n\t\t{show_label}\n\t\t{pending}\n\t\t{streaming}\n\t\t{mirror_webcam}\n\t>\n\t\t<UploadText type=\"image\" />\t\n\t</Image>\n\t{:else}\n\t\t<Image\n\t\t\t{brush_radius}\n\t\t\t{shape}\n\t\t\tbind:value\n\t\t\t{source}\n\t\t\t{tool}\n\t\t\t{selectable}\n\t\t\ton:edit\n\t\t\ton:clear\n\t\t\ton:change\n\t\t\ton:stream\n\t\t\ton:drag={({ detail }) => (dragging = detail)}\n\t\t\ton:upload\n\t\t\ton:select\n\t\t\ton:error={({ detail }) => {\n\t\t\t\tloading_status = loading_status || {};\n\t\t\t\tloading_status.status = \"error\";\n\t\t\t\tloading_status.message = detail;\n\t\t\t}}\n\t\t\t{label}\n\t\t\t{show_label}\n\t\t\t{pending}\n\t\t\t{streaming}\n\t\t\t{mirror_webcam}\n\t\t>\n\t\t\t<UploadText type=\"image\" />\n\t\t</Image>\n\t{/if}\n</Block>\n","export { default as Component } from \"./Image.svelte\";\nexport { default as ExampleComponent } from \"../Dataset/ExampleComponents/Image.svelte\";\nexport const modes = [\"static\", \"dynamic\"];\n\nexport const document = (config: Record<string, any>) => ({\n\ttype: {\n\t\tpayload: \"string\"\n\t},\n\tdescription: {\n\t\tpayload: \"image data as base64 string\"\n\t},\n\texample_data:\n\t\t\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAACklEQVR4nGMAAQAABQABDQottAAAAABJRU5ErkJggg==\"\n});\n"],"names":["insert","target","svg","anchor","append","path0","path1","circle0","circle1","circle2","circle3","circle4","path","get_coordinates_of_clicked_image","evt","image","imageRect","xScale","yScale","displayed_height","y_offset","x","y","displayed_width","x_offset","type","ctx","attr","img","img_src_value","$$props","el","dispatch","createEventDispatcher","cropper","destroy","create","Cropper","image_data","$$value","Point","LazyPoint","point","angle","distance","angleRotated","diff","RADIUS_DEFAULT","LazyBrush","radius","enabled","initialPoint","newPointerPoint","both","div","div_transition","create_bidirectional_transition","fade","canvas_1","listen","if_block","create_if_block","i","catenary_color","mid_point","p1","p2","value","value_img","mode","brush_color","brush_radius","source","width","height","container_height","shape","mounted","canvas_width","canvas_height","last_value_img","canvas_types","canvas","points","lines","mouse_has_moved","values_changed","is_drawing","is_pressing","lazy","canvas_container","canvas_observer","line_count","draw_cropped_image","_width","_height","shape_ratio","image_ratio","onMount","key","tick","_","trigger_on_change","draw_lines","$$invalidate","ResizeObserver","entries","observer","rest","handle_canvas_resize","loop","init","clear","initX","initY","onDestroy","redraw_image","_lines","clear_canvas","clear_mask","undo","line","_points","draw_points","draw_fake_points","saveLine","save_mask_line","handle_draw_start","e","get_pointer_pos","handle_pointer_move","handle_draw_move","handle_draw_end","old_width","old_height","old_container_height","add_lr_border","container_ratio","dimensions","container_dimensions","set_canvas_size","container","scale","dpr","rect","clientX","clientY","is_disabled","len","midPoint","get_image_data","once","pointer","brush","draw_interface","brush_dot","name","imagedata_to_image","imagedata","dataURL","image_to_imagedata","value_img_data_original","value_img_data_opaque","value_img_opaque","changed_objects","cropped_image","current_object_id","cropping_img_data","cropping_img","pos","pixels","erase_object","drag_start_x","drag_start_y","cropRect","find_bounding_box","selected_obj_id","min_x","min_y","max_x","max_y","index","create_cropped_image","obj_id","resolve","pixels_original","dst_img","construct_current_object","ids","obj","current_obj","blocking_function","identify_object_id","id_selected","id","handle_drag_start","handle_drag_move","drag_move_x","drag_move_y","draw_x","draw_y","handle_drag_end","Erase","Undo","Clear","show_eraser","click_handler","event","Brush","create_if_block_3","if_block1","create_if_block_1","span","input","Color","create_if_block_2","show_size","show_col","img_width","img_height","tool","to_number","click_handler_1","create_if_block_15","create_if_block_11","create_if_block_9","dirty","sketch_1_changes","compose_1_changes","src_url_equal","create_if_block_16","sketchsettings_changes","create_if_block_5","create_if_block_6","SketchIcon","Image","blocklabel_changes","label","show_label","streaming","pending","mirror_webcam","selectable","sketch","compose","handle_upload","detail","max_height","static_image","handle_clear","handle_save","initial","handle_select","dragging","handle_image_load","element","handle_sketch_clear","handle_mask_clear","max_width","handle_click","coordinates","clear_handler","edit_handler","undo_handler","undo_handler_1","clear_handler_1","edit_handler_1","undo_handler_2","FIXED_HEIGHT","block_changes","elem_id","elem_classes","visible","min_width","loading_status","modes","document","config"],"mappings":"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","x_google_ignoreList":[6,7,8]}